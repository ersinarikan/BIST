{
  "best_value": 78.35497835497836,
  "best_dirhit": 65.01623376623377,
  "best_params": {
    "enable_external_features": true,
    "enable_fingpt_features": true,
    "enable_yolo_features": false,
    "enable_directional_loss": true,
    "enable_seed_bagging": true,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": true,
    "enable_regime_detection": false,
    "enable_fingpt": true,
    "model_choice": "all",
    "ml_loss_mse_weight": 0.3489107415167482,
    "ml_loss_threshold": 0.002326405467138729,
    "ml_dir_penalty": 1.2950070462381185,
    "n_seeds": 3,
    "meta_stacking_alpha": 0.7065536630688681,
    "ml_adaptive_k_1d": 2.1766341354554455,
    "ml_pattern_weight_scale_1d": 0.9943265655172833,
    "enable_talib_patterns_short": true,
    "external_min_days": 46,
    "external_smooth_alpha": 0.35845647468450187,
    "smart_consensus_weight": 0.3400404793794737,
    "smart_performance_weight": 0.4258902885305094,
    "smart_sigma": 0.0015039773658667122,
    "smart_weight_xgb": 1.14165835808105,
    "smart_weight_lgbm": 1.0186824880049672,
    "smart_weight_cat": 1.3470425735051486,
    "fingpt_confidence_threshold": 0.2945441819741622,
    "xgb_n_estimators": 297,
    "xgb_max_depth": 6,
    "xgb_learning_rate": 0.08031491725012346,
    "xgb_subsample": 0.8429662137488594,
    "xgb_colsample_bytree": 0.6523477999751464,
    "xgb_reg_alpha": 0.025569548153687963,
    "xgb_reg_lambda": 0.049258136182194746,
    "xgb_min_child_weight": 6,
    "xgb_gamma": 0.000518915735614039,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 146,
    "lgb_n_estimators": 129,
    "lgb_max_depth": 4,
    "lgb_learning_rate": 0.015243915573145425,
    "lgb_num_leaves": 24,
    "lgb_subsample": 0.6371169218022533,
    "lgb_colsample_bytree": 0.8618700775930798,
    "lgb_reg_alpha": 0.9915670800459605,
    "lgb_reg_lambda": 0.0002751023726528655,
    "lgb_min_data_in_leaf": 23,
    "lgb_feature_fraction_bynode": 0.8022432753028962,
    "lgb_bagging_freq": 8,
    "lgb_min_gain_to_split": 0.26585356484805167,
    "cat_iterations": 134,
    "cat_depth": 6,
    "cat_learning_rate": 0.019757603178017315,
    "cat_l2_leaf_reg": 5.351487011029838,
    "cat_subsample": 0.856588638336226,
    "cat_rsm": 0.8769877353780458,
    "cat_border_count": 101,
    "cat_random_strength": 3.337880041389488,
    "cat_leaf_estimation_iterations": 14,
    "cat_bootstrap_type": "No"
  },
  "best_trial": {
    "number": 729,
    "value": 39.46544879926083,
    "state": "1"
  },
  "best_trial_number": 729,
  "best_trial_seed": 771,
  "n_trials": 754,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_ERCB_h1_c2",
  "symbols": [
    "ERCB"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": true,
    "enable_fingpt_features": true,
    "enable_yolo_features": false,
    "enable_directional_loss": true,
    "enable_seed_bagging": true,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": true,
    "enable_regime_detection": false,
    "enable_fingpt": true,
    "enable_talib_patterns_short": true
  },
  "feature_params": {
    "ml_loss_mse_weight": 0.3489107415167482,
    "ml_loss_threshold": 0.002326405467138729,
    "ml_dir_penalty": 1.2950070462381185,
    "n_seeds": 3,
    "meta_stacking_alpha": 0.7065536630688681,
    "ml_adaptive_k_1d": 2.1766341354554455,
    "ml_pattern_weight_scale_1d": 0.9943265655172833,
    "external_min_days": 46,
    "external_smooth_alpha": 0.35845647468450187,
    "smart_consensus_weight": 0.3400404793794737,
    "smart_performance_weight": 0.4258902885305094,
    "smart_sigma": 0.0015039773658667122,
    "smart_weight_xgb": 1.14165835808105,
    "smart_weight_lgbm": 1.0186824880049672,
    "smart_weight_cat": 1.3470425735051486,
    "fingpt_confidence_threshold": 0.2945441819741622
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 297,
    "xgb_max_depth": 6,
    "xgb_learning_rate": 0.08031491725012346,
    "xgb_subsample": 0.8429662137488594,
    "xgb_colsample_bytree": 0.6523477999751464,
    "xgb_reg_alpha": 0.025569548153687963,
    "xgb_reg_lambda": 0.049258136182194746,
    "xgb_min_child_weight": 6,
    "xgb_gamma": 0.000518915735614039,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 146,
    "lgb_n_estimators": 129,
    "lgb_max_depth": 4,
    "lgb_learning_rate": 0.015243915573145425,
    "lgb_num_leaves": 24,
    "lgb_subsample": 0.6371169218022533,
    "lgb_colsample_bytree": 0.8618700775930798,
    "lgb_reg_alpha": 0.9915670800459605,
    "lgb_reg_lambda": 0.0002751023726528655,
    "lgb_min_data_in_leaf": 23,
    "lgb_feature_fraction_bynode": 0.8022432753028962,
    "lgb_bagging_freq": 8,
    "lgb_min_gain_to_split": 0.26585356484805167,
    "cat_iterations": 134,
    "cat_depth": 6,
    "cat_learning_rate": 0.019757603178017315,
    "cat_l2_leaf_reg": 5.351487011029838,
    "cat_subsample": 0.856588638336226,
    "cat_rsm": 0.8769877353780458,
    "cat_border_count": 101,
    "cat_random_strength": 3.337880041389488,
    "cat_leaf_estimation_iterations": 14,
    "cat_bootstrap_type": "No"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "1",
    "ENABLE_FINGPT_FEATURES": "1",
    "ENABLE_YOLO_FEATURES": "0",
    "ML_USE_DIRECTIONAL_LOSS": "1",
    "ENABLE_SEED_BAGGING": "1",
    "ENABLE_TALIB_PATTERNS": "0",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "1",
    "ML_USE_REGIME_DETECTION": "0",
    "ENABLE_FINGPT": "1",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "ERCB_1d": {
      "symbol": "ERCB",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 454,
          "test_days": 30,
          "train_end_idx": 454,
          "test_end_idx": 484,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-16T00:00:00",
          "test_start": "2025-06-17T00:00:00",
          "test_end": "2025-07-29T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.3238480275280078,
              "rmse": 0.034050108430493234,
              "mape": 1.5290398624444168,
              "confidence": 0.40745129925243817
            },
            "lightgbm": {
              "raw_r2": -0.005785425499445533,
              "rmse": 0.029280878595627086,
              "mape": 1.8992763801286243,
              "confidence": 0.6202996695384992
            },
            "catboost": {
              "raw_r2": 0.0005171711636199708,
              "rmse": 0.029216697920440644,
              "mape": 1.7776550805608557,
              "confidence": 0.6254202013362963
            }
          },
          "dirhit": 71.42857142857143,
          "rmse": 0.022498533080949186,
          "mape": 146.91401052075102,
          "nrmse": 1.067719243787712,
          "mask_count": 7,
          "mask_pct": 24.137931034482758,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0
        },
        {
          "split_index": 2,
          "train_days": 484,
          "test_days": 30,
          "train_end_idx": 484,
          "test_end_idx": 514,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-29T00:00:00",
          "test_start": "2025-07-30T00:00:00",
          "test_end": "2025-09-09T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.2604711100763752,
              "rmse": 0.032834096370903176,
              "mape": 1.518056572483505,
              "confidence": 0.43894975159537963
            },
            "lightgbm": {
              "raw_r2": -0.0027977538521110437,
              "rmse": 0.028955308123695855,
              "mape": 1.928251834933972,
              "confidence": 0.6227268620634148
            },
            "catboost": {
              "raw_r2": 0.021389221108711554,
              "rmse": 0.02866716940961281,
              "mape": 1.7438937559878942,
              "confidence": 0.6423621970046026
            }
          },
          "dirhit": 100.0,
          "rmse": 0.023484827036121095,
          "mape": 998718.4044011156,
          "nrmse": 0.9626109712061874,
          "mask_count": 6,
          "mask_pct": 20.689655172413794,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0
        },
        {
          "split_index": 3,
          "train_days": 514,
          "test_days": 30,
          "train_end_idx": 514,
          "test_end_idx": 544,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-09T00:00:00",
          "test_start": "2025-09-10T00:00:00",
          "test_end": "2025-10-21T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.4299262448012416,
              "rmse": 0.0343296364637162,
              "mape": 1.5126648559108207,
              "confidence": 0.3678376977654319
            },
            "lightgbm": {
              "raw_r2": -0.0072174280600903655,
              "rmse": 0.02816760937257414,
              "mape": 1.8420698553321284,
              "confidence": 0.6191364760173615
            },
            "catboost": {
              "raw_r2": 0.010718223998250473,
              "rmse": 0.027956160237189144,
              "mape": 1.7210547501130755,
              "confidence": 0.6337064733431204
            }
          },
          "dirhit": 25.0,
          "rmse": 0.022439192999981695,
          "mape": 99.86441818489041,
          "nrmse": 1.0231304783452082,
          "mask_count": 4,
          "mask_pct": 13.793103448275861,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0
        },
        {
          "split_index": 4,
          "train_days": 544,
          "test_days": 30,
          "train_end_idx": 544,
          "test_end_idx": 574,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-21T00:00:00",
          "test_start": "2025-10-22T00:00:00",
          "test_end": "2025-12-02T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.4204827488051231,
              "rmse": 0.03202478852988898,
              "mape": 1.526772584815914,
              "confidence": 0.3707605855580644
            },
            "lightgbm": {
              "raw_r2": -0.016491059215325638,
              "rmse": 0.02669995103558313,
              "mape": 1.8179412959975594,
              "confidence": 0.6116086007330367
            },
            "catboost": {
              "raw_r2": -0.0019907029057646777,
              "rmse": 0.026515794586602866,
              "mape": 1.7305398941360228,
              "confidence": 0.6233825672426299
            }
          },
          "dirhit": 63.63636363636363,
          "rmse": 0.04986757880482965,
          "mape": 4698760.856838071,
          "nrmse": 0.9771491980627663,
          "mask_count": 11,
          "mask_pct": 37.93103448275862,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0
        }
      ],
      "avg_dirhit": 65.01623376623377,
      "avg_nrmse": 1.0076524728504683,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.3586820328026869,
          "rmse": 0.0333096574487504,
          "mape": 1.5216334689136641,
          "confidence": 0.39624983354282856
        },
        "lightgbm": {
          "raw_r2": -0.008072916656743145,
          "rmse": 0.028275936781870053,
          "mape": 1.871884841598071,
          "confidence": 0.6184429020880781
        },
        "catboost": {
          "raw_r2": 0.007658478341204329,
          "rmse": 0.028088955538461365,
          "mape": 1.743285870199462,
          "confidence": 0.6312178597316622
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 729,
    "best_trial_seed": 771,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "ERCB_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 454,
            "test_end_idx": 484,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-16T00:00:00",
            "test_start": "2025-06-17T00:00:00",
            "test_end": "2025-07-29T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 484,
            "test_end_idx": 514,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-29T00:00:00",
            "test_start": "2025-07-30T00:00:00",
            "test_end": "2025-09-09T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 514,
            "test_end_idx": 544,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-09T00:00:00",
            "test_start": "2025-09-10T00:00:00",
            "test_end": "2025-10-21T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 544,
            "test_end_idx": 574,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-21T00:00:00",
            "test_start": "2025-10-22T00:00:00",
            "test_end": "2025-12-02T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T04:11:13.183288",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}