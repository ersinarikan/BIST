{
  "best_value": 60.04329004329004,
  "best_dirhit": 60.04329004329004,
  "best_params": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": true,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": false,
    "model_choice": "all",
    "ml_adaptive_k_1d": 2.6397664068872873,
    "ml_pattern_weight_scale_1d": 1.1308490527840045,
    "enable_talib_patterns_short": false,
    "external_min_days": 57,
    "external_smooth_alpha": 0.10488536566159684,
    "regime_scale_low": 0.8358313195057655,
    "regime_scale_high": 1.1802899070695687,
    "yolo_min_conf": 0.7386350946410978,
    "smart_consensus_weight": 0.6351375615435616,
    "smart_performance_weight": 0.4973756989434557,
    "smart_sigma": 0.0010595278589164683,
    "smart_weight_xgb": 1.1855874420039472,
    "smart_weight_lgbm": 0.9016753235650385,
    "smart_weight_cat": 1.2088527128026867,
    "xgb_n_estimators": 150,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.02421285517273626,
    "xgb_subsample": 0.8220201199150804,
    "xgb_colsample_bytree": 0.6910275510340638,
    "xgb_reg_alpha": 0.0007427898231277096,
    "xgb_reg_lambda": 3.993488676406988,
    "xgb_min_child_weight": 10,
    "xgb_gamma": 0.17911245668064213,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 490,
    "lgb_n_estimators": 354,
    "lgb_max_depth": 6,
    "lgb_learning_rate": 0.032710691881600126,
    "lgb_num_leaves": 37,
    "lgb_subsample": 0.8386503847215319,
    "lgb_colsample_bytree": 0.7364678210194603,
    "lgb_reg_alpha": 0.0017043620164273955,
    "lgb_reg_lambda": 0.9341019472603925,
    "lgb_min_data_in_leaf": 90,
    "lgb_feature_fraction_bynode": 0.876697819897516,
    "lgb_bagging_freq": 0,
    "lgb_min_gain_to_split": 0.07207368824225893,
    "cat_iterations": 139,
    "cat_depth": 8,
    "cat_learning_rate": 0.03941308358151933,
    "cat_l2_leaf_reg": 8.17185112782356,
    "cat_subsample": 0.8318393084576231,
    "cat_rsm": 0.5548107034027651,
    "cat_border_count": 16,
    "cat_random_strength": 3.7677382969911526,
    "cat_leaf_estimation_iterations": 18,
    "cat_bootstrap_type": "MVS"
  },
  "best_trial": {
    "number": 228,
    "value": 35.74224557562375,
    "state": "1"
  },
  "best_trial_number": 228,
  "best_trial_seed": 270,
  "n_trials": 245,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_DAGI_h1_c2",
  "symbols": [
    "DAGI"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": true,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": false,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_adaptive_k_1d": 2.6397664068872873,
    "ml_pattern_weight_scale_1d": 1.1308490527840045,
    "external_min_days": 57,
    "external_smooth_alpha": 0.10488536566159684,
    "regime_scale_low": 0.8358313195057655,
    "regime_scale_high": 1.1802899070695687,
    "yolo_min_conf": 0.7386350946410978,
    "smart_consensus_weight": 0.6351375615435616,
    "smart_performance_weight": 0.4973756989434557,
    "smart_sigma": 0.0010595278589164683,
    "smart_weight_xgb": 1.1855874420039472,
    "smart_weight_lgbm": 0.9016753235650385,
    "smart_weight_cat": 1.2088527128026867
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 150,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.02421285517273626,
    "xgb_subsample": 0.8220201199150804,
    "xgb_colsample_bytree": 0.6910275510340638,
    "xgb_reg_alpha": 0.0007427898231277096,
    "xgb_reg_lambda": 3.993488676406988,
    "xgb_min_child_weight": 10,
    "xgb_gamma": 0.17911245668064213,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 490,
    "lgb_n_estimators": 354,
    "lgb_max_depth": 6,
    "lgb_learning_rate": 0.032710691881600126,
    "lgb_num_leaves": 37,
    "lgb_subsample": 0.8386503847215319,
    "lgb_colsample_bytree": 0.7364678210194603,
    "lgb_reg_alpha": 0.0017043620164273955,
    "lgb_reg_lambda": 0.9341019472603925,
    "lgb_min_data_in_leaf": 90,
    "lgb_feature_fraction_bynode": 0.876697819897516,
    "lgb_bagging_freq": 0,
    "lgb_min_gain_to_split": 0.07207368824225893,
    "cat_iterations": 139,
    "cat_depth": 8,
    "cat_learning_rate": 0.03941308358151933,
    "cat_l2_leaf_reg": 8.17185112782356,
    "cat_subsample": 0.8318393084576231,
    "cat_rsm": 0.5548107034027651,
    "cat_border_count": 16,
    "cat_random_strength": 3.7677382969911526,
    "cat_leaf_estimation_iterations": 18,
    "cat_bootstrap_type": "MVS"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "0",
    "ENABLE_FINGPT_FEATURES": "0",
    "ENABLE_YOLO_FEATURES": "1",
    "ML_USE_DIRECTIONAL_LOSS": "0",
    "ENABLE_SEED_BAGGING": "0",
    "ENABLE_TALIB_PATTERNS": "0",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "1",
    "ENABLE_FINGPT": "0",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "DAGI_1d": {
      "symbol": "DAGI",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 453,
          "test_days": 30,
          "train_end_idx": 453,
          "test_end_idx": 483,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-12T00:00:00",
          "test_start": "2025-06-13T00:00:00",
          "test_end": "2025-07-25T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.009893880407813175,
              "rmse": 0.037920062737309634,
              "mape": 1.8321942600322954,
              "confidence": 0.6169628611568776
            },
            "lightgbm": {
              "raw_r2": -0.012978925449967113,
              "rmse": 0.037955391989925265,
              "mape": 1.839687773513026,
              "confidence": 0.614458322337301
            },
            "catboost": {
              "raw_r2": -0.007044591805345816,
              "rmse": 0.03781063692034894,
              "mape": 1.7684398024684114,
              "confidence": 0.6192768608502341
            }
          },
          "dirhit": 71.42857142857143,
          "rmse": 0.040759879997631344,
          "mape": 1673854.377773719,
          "nrmse": 0.9507700580699118,
          "mask_count": 14,
          "mask_pct": 48.275862068965516,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.009893880407813175,
              "lightgbm": -0.012978925449967113,
              "catboost": -0.007044591805345816
            },
            "ensemble_weights": {
              "xgboost": 0.14955746678845339,
              "lightgbm": 0.11356768818791885,
              "catboost": 0.7368748450236278
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 483,
          "test_days": 30,
          "train_end_idx": 483,
          "test_end_idx": 513,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-25T00:00:00",
          "test_start": "2025-07-28T00:00:00",
          "test_end": "2025-09-05T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.005002876939120974,
              "rmse": 0.03868906317588372,
              "mape": 1.83572474546872,
              "confidence": 0.620935374427691
            },
            "lightgbm": {
              "raw_r2": -0.007379950510613871,
              "rmse": 0.038721605104557986,
              "mape": 1.834241213420719,
              "confidence": 0.6190044704833103
            },
            "catboost": {
              "raw_r2": 0.002557555232537275,
              "rmse": 0.0385436967758713,
              "mape": 1.7892760959572445,
              "confidence": 0.6270779853092505
            }
          },
          "dirhit": 46.666666666666664,
          "rmse": 0.04404342565232052,
          "mape": 7828818.574783234,
          "nrmse": 1.151305717990762,
          "mask_count": 15,
          "mask_pct": 51.724137931034484,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.005002876939120974,
              "lightgbm": -0.007379950510613871,
              "catboost": 0.002557555232537275
            },
            "ensemble_weights": {
              "xgboost": 0.14945944855040616,
              "lightgbm": 0.11389550986370212,
              "catboost": 0.7366450415858917
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 513,
          "test_days": 30,
          "train_end_idx": 513,
          "test_end_idx": 543,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-05T00:00:00",
          "test_start": "2025-09-08T00:00:00",
          "test_end": "2025-10-17T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.005728788073137221,
              "rmse": 0.03898104734313448,
              "mape": 1.7796716357235283,
              "confidence": 0.6203456779159244
            },
            "lightgbm": {
              "raw_r2": -0.008636520365380354,
              "rmse": 0.03903285530390176,
              "mape": 1.8741401194334795,
              "confidence": 0.6179839174317012
            },
            "catboost": {
              "raw_r2": 0.000489297978891412,
              "rmse": 0.038822847157455334,
              "mape": 1.763315574400818,
              "confidence": 0.6253975544095587
            }
          },
          "dirhit": 85.71428571428571,
          "rmse": 0.028806043666250815,
          "mape": 1525902.0930180415,
          "nrmse": 0.979084328364652,
          "mask_count": 7,
          "mask_pct": 24.137931034482758,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.005728788073137221,
              "lightgbm": -0.008636520365380354,
              "catboost": 0.000489297978891412
            },
            "ensemble_weights": {
              "xgboost": 0.14946577044560114,
              "lightgbm": 0.1135081205908537,
              "catboost": 0.7370261089635451
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 543,
          "test_days": 30,
          "train_end_idx": 543,
          "test_end_idx": 573,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-17T00:00:00",
          "test_start": "2025-10-20T00:00:00",
          "test_end": "2025-11-28T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.0021942707247352513,
              "rmse": 0.03882634859383823,
              "mape": 1.7545865901901183,
              "confidence": 0.6232171729194472
            },
            "lightgbm": {
              "raw_r2": -0.004067781198111057,
              "rmse": 0.038866150212690964,
              "mape": 1.8452494862478837,
              "confidence": 0.6216950417062261
            },
            "catboost": {
              "raw_r2": 0.031161030252380078,
              "rmse": 0.03820067166159666,
              "mape": 1.676784105747954,
              "confidence": 0.6502672437035948
            }
          },
          "dirhit": 36.36363636363637,
          "rmse": 0.029324399342175234,
          "mape": 8050423.56217049,
          "nrmse": 1.1108781986941927,
          "mask_count": 11,
          "mask_pct": 37.93103448275862,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.0021942707247352513,
              "lightgbm": -0.004067781198111057,
              "catboost": 0.031161030252380078
            },
            "ensemble_weights": {
              "xgboost": 0.35876362837220266,
              "lightgbm": 0.27273878860454337,
              "catboost": 0.36849758302325397
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 60.04329004329004,
      "avg_nrmse": 1.0480095757798797,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.005704954036201655,
          "rmse": 0.03860413046254152,
          "mape": 1.8005443078536656,
          "confidence": 0.6203652716049851
        },
        "lightgbm": {
          "raw_r2": -0.008265794381018099,
          "rmse": 0.038644000652768996,
          "mape": 1.848329648153777,
          "confidence": 0.6182854379896346
        },
        "catboost": {
          "raw_r2": 0.0067908229146157375,
          "rmse": 0.03834446312881806,
          "mape": 1.749453894643607,
          "confidence": 0.6305049110681595
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 228,
    "best_trial_seed": 270,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "DAGI_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 453,
            "test_end_idx": 483,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-12T00:00:00",
            "test_start": "2025-06-13T00:00:00",
            "test_end": "2025-07-25T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 483,
            "test_end_idx": 513,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-25T00:00:00",
            "test_start": "2025-07-28T00:00:00",
            "test_end": "2025-09-05T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 513,
            "test_end_idx": 543,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-05T00:00:00",
            "test_start": "2025-09-08T00:00:00",
            "test_end": "2025-10-17T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 543,
            "test_end_idx": 573,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-17T00:00:00",
            "test_start": "2025-10-20T00:00:00",
            "test_end": "2025-11-28T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:50:37.429712",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}