{
  "best_value": 65.0,
  "best_dirhit": 65.0,
  "best_params": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": false,
    "enable_directional_loss": false,
    "enable_seed_bagging": true,
    "enable_talib_patterns": true,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "model_choice": "all",
    "n_seeds": 2,
    "ml_adaptive_k_1d": 2.0875297751596658,
    "ml_pattern_weight_scale_1d": 0.6290468002632985,
    "enable_talib_patterns_short": false,
    "external_min_days": 51,
    "external_smooth_alpha": 0.13646465398693913,
    "regime_scale_low": 0.9295930368929224,
    "regime_scale_high": 1.1188954849982788,
    "smart_consensus_weight": 0.6389461404858037,
    "smart_performance_weight": 0.5826192784477688,
    "smart_sigma": 0.005125782793565297,
    "smart_weight_xgb": 1.344234585435969,
    "smart_weight_lgbm": 1.1986715026455679,
    "smart_weight_cat": 1.205955270849487,
    "xgb_n_estimators": 531,
    "xgb_max_depth": 4,
    "xgb_learning_rate": 0.05521366046143675,
    "xgb_subsample": 0.6980103194521732,
    "xgb_colsample_bytree": 0.8415128772415224,
    "xgb_reg_alpha": 1.7602357970322152e-05,
    "xgb_reg_lambda": 6.755607158256131,
    "xgb_min_child_weight": 9,
    "xgb_gamma": 0.019630255682687666,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 359,
    "lgb_n_estimators": 525,
    "lgb_max_depth": 7,
    "lgb_learning_rate": 0.03448283467410917,
    "lgb_num_leaves": 30,
    "lgb_subsample": 0.5060038451940305,
    "lgb_colsample_bytree": 0.8475671433920662,
    "lgb_reg_alpha": 2.8532897495060438e-05,
    "lgb_reg_lambda": 0.00045413205497245996,
    "lgb_min_data_in_leaf": 59,
    "lgb_feature_fraction_bynode": 0.5135872252222947,
    "lgb_bagging_freq": 4,
    "lgb_min_gain_to_split": 0.7042904628018907,
    "cat_iterations": 134,
    "cat_depth": 3,
    "cat_learning_rate": 0.020870336878595974,
    "cat_l2_leaf_reg": 2.3881435693418203,
    "cat_subsample": 0.9118881027325516,
    "cat_rsm": 0.5066968724069112,
    "cat_border_count": 29,
    "cat_random_strength": 1.652571746502994,
    "cat_leaf_estimation_iterations": 16,
    "cat_bootstrap_type": "No"
  },
  "best_trial": {
    "number": 525,
    "value": 39.31427268621941,
    "state": "1"
  },
  "best_trial_number": 525,
  "best_trial_seed": 567,
  "n_trials": 1390,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_CLEBI_h1_c2",
  "symbols": [
    "CLEBI"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": false,
    "enable_directional_loss": false,
    "enable_seed_bagging": true,
    "enable_talib_patterns": true,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "n_seeds": 2,
    "ml_adaptive_k_1d": 2.0875297751596658,
    "ml_pattern_weight_scale_1d": 0.6290468002632985,
    "external_min_days": 51,
    "external_smooth_alpha": 0.13646465398693913,
    "regime_scale_low": 0.9295930368929224,
    "regime_scale_high": 1.1188954849982788,
    "smart_consensus_weight": 0.6389461404858037,
    "smart_performance_weight": 0.5826192784477688,
    "smart_sigma": 0.005125782793565297,
    "smart_weight_xgb": 1.344234585435969,
    "smart_weight_lgbm": 1.1986715026455679,
    "smart_weight_cat": 1.205955270849487
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 531,
    "xgb_max_depth": 4,
    "xgb_learning_rate": 0.05521366046143675,
    "xgb_subsample": 0.6980103194521732,
    "xgb_colsample_bytree": 0.8415128772415224,
    "xgb_reg_alpha": 1.7602357970322152e-05,
    "xgb_reg_lambda": 6.755607158256131,
    "xgb_min_child_weight": 9,
    "xgb_gamma": 0.019630255682687666,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 359,
    "lgb_n_estimators": 525,
    "lgb_max_depth": 7,
    "lgb_learning_rate": 0.03448283467410917,
    "lgb_num_leaves": 30,
    "lgb_subsample": 0.5060038451940305,
    "lgb_colsample_bytree": 0.8475671433920662,
    "lgb_reg_alpha": 2.8532897495060438e-05,
    "lgb_reg_lambda": 0.00045413205497245996,
    "lgb_min_data_in_leaf": 59,
    "lgb_feature_fraction_bynode": 0.5135872252222947,
    "lgb_bagging_freq": 4,
    "lgb_min_gain_to_split": 0.7042904628018907,
    "cat_iterations": 134,
    "cat_depth": 3,
    "cat_learning_rate": 0.020870336878595974,
    "cat_l2_leaf_reg": 2.3881435693418203,
    "cat_subsample": 0.9118881027325516,
    "cat_rsm": 0.5066968724069112,
    "cat_border_count": 29,
    "cat_random_strength": 1.652571746502994,
    "cat_leaf_estimation_iterations": 16,
    "cat_bootstrap_type": "No"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "0",
    "ENABLE_FINGPT_FEATURES": "0",
    "ENABLE_YOLO_FEATURES": "0",
    "ML_USE_DIRECTIONAL_LOSS": "0",
    "ENABLE_SEED_BAGGING": "1",
    "ENABLE_TALIB_PATTERNS": "1",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "1",
    "ENABLE_FINGPT": "1",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "CLEBI_1d": {
      "symbol": "CLEBI",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 452,
          "test_days": 30,
          "train_end_idx": 452,
          "test_end_idx": 482,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-12T00:00:00",
          "test_start": "2025-06-13T00:00:00",
          "test_end": "2025-07-25T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.017241773927254456,
              "rmse": 0.033571155300650746,
              "mape": 1.5481885455498865,
              "confidence": 0.6109997284092197
            },
            "lightgbm": {
              "raw_r2": -0.04736318252284888,
              "rmse": 0.034269569502294775,
              "mape": 1.6513050061059833,
              "confidence": 0.5866962589220286
            },
            "catboost": {
              "raw_r2": -0.043463058389949426,
              "rmse": 0.03413143012975877,
              "mape": 1.6009494463878642,
              "confidence": 0.589824588863616
            }
          },
          "dirhit": 80.0,
          "rmse": 0.034180314653198686,
          "mape": 1008125.0135337601,
          "nrmse": 0.9780988694038726,
          "mask_count": 10,
          "mask_pct": 34.48275862068966,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.017241773927254456,
              "lightgbm": -0.04736318252284888,
              "catboost": -0.043463058389949426
            },
            "ensemble_weights": {
              "xgboost": 0.36011954952959335,
              "lightgbm": 0.31882269079914777,
              "catboost": 0.32105775967125905
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 482,
          "test_days": 30,
          "train_end_idx": 482,
          "test_end_idx": 512,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-25T00:00:00",
          "test_start": "2025-07-28T00:00:00",
          "test_end": "2025-09-05T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.015276196209788631,
              "rmse": 0.03435071528169608,
              "mape": 1.6959111737000419,
              "confidence": 0.6125941213739317
            },
            "lightgbm": {
              "raw_r2": -0.022496329000787057,
              "rmse": 0.03441171284047924,
              "mape": 1.6487954594124177,
              "confidence": 0.6067409799054059
            },
            "catboost": {
              "raw_r2": -0.017338166140931716,
              "rmse": 0.03428725073052841,
              "mape": 1.6436558748638295,
              "confidence": 0.6109215558840593
            }
          },
          "dirhit": null,
          "rmse": 0.016503258425559955,
          "mape": 119.45006700159813,
          "nrmse": 1.091350163675567,
          "mask_count": 5,
          "mask_pct": 17.24137931034483,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.015276196209788631,
              "lightgbm": -0.022496329000787057,
              "catboost": -0.017338166140931716
            },
            "ensemble_weights": {
              "xgboost": 0.35882555658670245,
              "lightgbm": 0.31941905072784976,
              "catboost": 0.3217553926854479
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 512,
          "test_days": 30,
          "train_end_idx": 512,
          "test_end_idx": 542,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-05T00:00:00",
          "test_start": "2025-09-08T00:00:00",
          "test_end": "2025-10-17T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.006232777634839352,
              "rmse": 0.03327348155617904,
              "mape": 1.6904597380708744,
              "confidence": 0.6199362779838666
            },
            "lightgbm": {
              "raw_r2": -0.015141063444654712,
              "rmse": 0.03335499321937057,
              "mape": 1.6332925055184535,
              "confidence": 0.6127037581728163
            },
            "catboost": {
              "raw_r2": -0.009589205411723515,
              "rmse": 0.03324204947370955,
              "mape": 1.6173420680594115,
              "confidence": 0.617210262813754
            }
          },
          "dirhit": 50.0,
          "rmse": 0.02382752817381419,
          "mape": 148.4301630735785,
          "nrmse": 0.9847734613599178,
          "mask_count": 12,
          "mask_pct": 41.37931034482759,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.006232777634839352,
              "lightgbm": -0.015141063444654712,
              "catboost": -0.009589205411723515
            },
            "ensemble_weights": {
              "xgboost": 0.3589073728029554,
              "lightgbm": 0.31936327831119715,
              "catboost": 0.3217293488858474
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 542,
          "test_days": 30,
          "train_end_idx": 542,
          "test_end_idx": 572,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-17T00:00:00",
          "test_start": "2025-10-20T00:00:00",
          "test_end": "2025-11-28T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.007187264378687626,
              "rmse": 0.032195692230852564,
              "mape": 1.656386323781823,
              "confidence": 0.6191609760644418
            },
            "lightgbm": {
              "raw_r2": -0.020900447308342434,
              "rmse": 0.03238786122274746,
              "mape": 1.6322872284051562,
              "confidence": 0.6080338239869212
            },
            "catboost": {
              "raw_r2": -0.011340117529343755,
              "rmse": 0.03218863732746282,
              "mape": 1.6401316537679553,
              "confidence": 0.6157886222235296
            }
          },
          "dirhit": null,
          "rmse": 0.023902974947079738,
          "mape": 2150817.6481875167,
          "nrmse": 1.0695957147477007,
          "mask_count": 4,
          "mask_pct": 13.793103448275861,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.007187264378687626,
              "lightgbm": -0.020900447308342434,
              "catboost": -0.011340117529343755
            },
            "ensemble_weights": {
              "xgboost": 0.3590606215822334,
              "lightgbm": 0.31913394067285883,
              "catboost": 0.32180543774490783
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 65.0,
      "avg_nrmse": 1.0309545522967645,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.011484503037642516,
          "rmse": 0.03334776109234461,
          "mape": 1.6477364452756564,
          "confidence": 0.615672775957865
        },
        "lightgbm": {
          "raw_r2": -0.026475255569158272,
          "rmse": 0.03360603419622302,
          "mape": 1.6414200498605027,
          "confidence": 0.603543705246793
        },
        "catboost": {
          "raw_r2": -0.020432636867987106,
          "rmse": 0.03346234191536489,
          "mape": 1.6255197607697651,
          "confidence": 0.6084362574462396
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 525,
    "best_trial_seed": 567,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "CLEBI_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 452,
            "test_end_idx": 482,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-12T00:00:00",
            "test_start": "2025-06-13T00:00:00",
            "test_end": "2025-07-25T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 482,
            "test_end_idx": 512,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-25T00:00:00",
            "test_start": "2025-07-28T00:00:00",
            "test_end": "2025-09-05T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 512,
            "test_end_idx": 542,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-05T00:00:00",
            "test_start": "2025-09-08T00:00:00",
            "test_end": "2025-10-17T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 542,
            "test_end_idx": 572,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-17T00:00:00",
            "test_start": "2025-10-20T00:00:00",
            "test_end": "2025-11-28T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:49:53.030320",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}