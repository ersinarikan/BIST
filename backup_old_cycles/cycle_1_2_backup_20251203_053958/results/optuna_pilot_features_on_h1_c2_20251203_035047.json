{
  "best_value": 74.72222222222221,
  "best_dirhit": 74.72222222222221,
  "best_params": {
    "enable_external_features": true,
    "enable_fingpt_features": false,
    "enable_yolo_features": true,
    "enable_directional_loss": true,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": true,
    "enable_meta_stacking": false,
    "enable_regime_detection": false,
    "enable_fingpt": false,
    "model_choice": "all",
    "ml_loss_mse_weight": 0.33054083501260767,
    "ml_loss_threshold": 0.006862597845345521,
    "ml_dir_penalty": 1.7131514728132728,
    "ml_adaptive_k_1d": 1.6543130090309197,
    "ml_pattern_weight_scale_1d": 1.9725445734676548,
    "enable_talib_patterns_short": false,
    "external_min_days": 50,
    "external_smooth_alpha": 0.4748472248568327,
    "yolo_min_conf": 0.4801556073717136,
    "smart_consensus_weight": 0.547981740974228,
    "smart_performance_weight": 0.680990255509949,
    "smart_sigma": 0.0030292365748688837,
    "smart_weight_xgb": 0.8331422014887342,
    "smart_weight_lgbm": 1.2946817464147822,
    "smart_weight_cat": 1.3613159874001772,
    "xgb_n_estimators": 386,
    "xgb_max_depth": 3,
    "xgb_learning_rate": 0.042563825696482975,
    "xgb_subsample": 0.5988261294238691,
    "xgb_colsample_bytree": 0.5855488265399501,
    "xgb_reg_alpha": 0.0007824147730512896,
    "xgb_reg_lambda": 0.0019425908744943937,
    "xgb_min_child_weight": 6,
    "xgb_gamma": 0.1473028711336318,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 178,
    "lgb_n_estimators": 131,
    "lgb_max_depth": 6,
    "lgb_learning_rate": 0.0753334657815552,
    "lgb_num_leaves": 60,
    "lgb_subsample": 0.7430819872878774,
    "lgb_colsample_bytree": 0.7657289328334114,
    "lgb_reg_alpha": 3.935920066555555e-06,
    "lgb_reg_lambda": 0.06353549932195562,
    "lgb_min_data_in_leaf": 98,
    "lgb_feature_fraction_bynode": 0.5469399707137441,
    "lgb_bagging_freq": 3,
    "lgb_min_gain_to_split": 0.4876169322050276,
    "cat_iterations": 228,
    "cat_depth": 5,
    "cat_learning_rate": 0.01985826511812172,
    "cat_l2_leaf_reg": 7.673754830110473,
    "cat_subsample": 0.7501904233667751,
    "cat_rsm": 0.6405669561974545,
    "cat_border_count": 255,
    "cat_random_strength": 4.699769755382973,
    "cat_leaf_estimation_iterations": 3,
    "cat_bootstrap_type": "MVS"
  },
  "best_trial": {
    "number": 987,
    "value": 44.80706571422227,
    "state": "1"
  },
  "best_trial_number": 987,
  "best_trial_seed": 1029,
  "n_trials": 1417,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_DAPGM_h1_c2",
  "symbols": [
    "DAPGM"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": true,
    "enable_fingpt_features": false,
    "enable_yolo_features": true,
    "enable_directional_loss": true,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": true,
    "enable_meta_stacking": false,
    "enable_regime_detection": false,
    "enable_fingpt": false,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_loss_mse_weight": 0.33054083501260767,
    "ml_loss_threshold": 0.006862597845345521,
    "ml_dir_penalty": 1.7131514728132728,
    "ml_adaptive_k_1d": 1.6543130090309197,
    "ml_pattern_weight_scale_1d": 1.9725445734676548,
    "external_min_days": 50,
    "external_smooth_alpha": 0.4748472248568327,
    "yolo_min_conf": 0.4801556073717136,
    "smart_consensus_weight": 0.547981740974228,
    "smart_performance_weight": 0.680990255509949,
    "smart_sigma": 0.0030292365748688837,
    "smart_weight_xgb": 0.8331422014887342,
    "smart_weight_lgbm": 1.2946817464147822,
    "smart_weight_cat": 1.3613159874001772
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 386,
    "xgb_max_depth": 3,
    "xgb_learning_rate": 0.042563825696482975,
    "xgb_subsample": 0.5988261294238691,
    "xgb_colsample_bytree": 0.5855488265399501,
    "xgb_reg_alpha": 0.0007824147730512896,
    "xgb_reg_lambda": 0.0019425908744943937,
    "xgb_min_child_weight": 6,
    "xgb_gamma": 0.1473028711336318,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 178,
    "lgb_n_estimators": 131,
    "lgb_max_depth": 6,
    "lgb_learning_rate": 0.0753334657815552,
    "lgb_num_leaves": 60,
    "lgb_subsample": 0.7430819872878774,
    "lgb_colsample_bytree": 0.7657289328334114,
    "lgb_reg_alpha": 3.935920066555555e-06,
    "lgb_reg_lambda": 0.06353549932195562,
    "lgb_min_data_in_leaf": 98,
    "lgb_feature_fraction_bynode": 0.5469399707137441,
    "lgb_bagging_freq": 3,
    "lgb_min_gain_to_split": 0.4876169322050276,
    "cat_iterations": 228,
    "cat_depth": 5,
    "cat_learning_rate": 0.01985826511812172,
    "cat_l2_leaf_reg": 7.673754830110473,
    "cat_subsample": 0.7501904233667751,
    "cat_rsm": 0.6405669561974545,
    "cat_border_count": 255,
    "cat_random_strength": 4.699769755382973,
    "cat_leaf_estimation_iterations": 3,
    "cat_bootstrap_type": "MVS"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "1",
    "ENABLE_FINGPT_FEATURES": "0",
    "ENABLE_YOLO_FEATURES": "1",
    "ML_USE_DIRECTIONAL_LOSS": "1",
    "ENABLE_SEED_BAGGING": "0",
    "ENABLE_TALIB_PATTERNS": "0",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "1",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "0",
    "ENABLE_FINGPT": "0",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "DAPGM_1d": {
      "symbol": "DAPGM",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 453,
          "test_days": 30,
          "train_end_idx": 453,
          "test_end_idx": 483,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-12T00:00:00",
          "test_start": "2025-06-13T00:00:00",
          "test_end": "2025-07-25T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -2.142333669580681,
              "rmse": 0.05340896031367719,
              "mape": 1.4630455179182535,
              "confidence": 0.30001448389019586
            },
            "lightgbm": {
              "raw_r2": -0.04937019198092071,
              "rmse": 0.03101038621568648,
              "mape": 1.8111973960105514,
              "confidence": 0.585089178632396
            },
            "catboost": {
              "raw_r2": 0.006703403808745974,
              "rmse": 0.03017603367918834,
              "mape": 1.577941565341133,
              "confidence": 0.6304460057715262
            }
          },
          "dirhit": null,
          "rmse": 0.03131332381818656,
          "mape": 250989.14163356766,
          "nrmse": 1.0219203219945834,
          "mask_count": 7,
          "mask_pct": 24.137931034482758,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0
        },
        {
          "split_index": 2,
          "train_days": 483,
          "test_days": 30,
          "train_end_idx": 483,
          "test_end_idx": 513,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-25T00:00:00",
          "test_start": "2025-07-28T00:00:00",
          "test_end": "2025-09-05T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -2.1470803738734108,
              "rmse": 0.053855775587292765,
              "mape": 1.4701358611528232,
              "confidence": 0.3000141441910313
            },
            "lightgbm": {
              "raw_r2": -0.03195904407020289,
              "rmse": 0.03086944726981353,
              "mape": 1.8257520539286352,
              "confidence": 0.5990883899365476
            },
            "catboost": {
              "raw_r2": 1.419536732975383e-07,
              "rmse": 0.03036362058767752,
              "mape": 1.592045538402389,
              "confidence": 0.6250001153373596
            }
          },
          "dirhit": 95.0,
          "rmse": 0.03821114974311371,
          "mape": 454.93909295252746,
          "nrmse": 1.0683433709052557,
          "mask_count": 20,
          "mask_pct": 68.96551724137932,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0
        },
        {
          "split_index": 3,
          "train_days": 513,
          "test_days": 30,
          "train_end_idx": 513,
          "test_end_idx": 543,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-05T00:00:00",
          "test_start": "2025-09-08T00:00:00",
          "test_end": "2025-10-17T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -2.031632354877598,
              "rmse": 0.05378274693671435,
              "mape": 1.4529554882455205,
              "confidence": 0.3000251920157698
            },
            "lightgbm": {
              "raw_r2": -0.03571261162908305,
              "rmse": 0.03167720363114157,
              "mape": 1.834070757646307,
              "confidence": 0.5960603566985841
            },
            "catboost": {
              "raw_r2": -0.0031013702338445284,
              "rmse": 0.031196942024307377,
              "mape": 1.6827611150949995,
              "confidence": 0.6224801871781591
            }
          },
          "dirhit": 62.5,
          "rmse": 0.050029492005348196,
          "mape": 343.85862953584007,
          "nrmse": 1.1948934602568524,
          "mask_count": 24,
          "mask_pct": 82.75862068965517,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0
        },
        {
          "split_index": 4,
          "train_days": 543,
          "test_days": 30,
          "train_end_idx": 543,
          "test_end_idx": 573,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-17T00:00:00",
          "test_start": "2025-10-20T00:00:00",
          "test_end": "2025-11-28T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -2.06318656241647,
              "rmse": 0.05576183029785673,
              "mape": 1.4631572008525127,
              "confidence": 0.3000215152444672
            },
            "lightgbm": {
              "raw_r2": -0.016421505633116878,
              "rmse": 0.03264582470335971,
              "mape": 1.8647791477360247,
              "confidence": 0.6116650174759618
            },
            "catboost": {
              "raw_r2": 1.2224843154070205e-05,
              "rmse": 0.0323901669325262,
              "mape": 1.7033990325105,
              "confidence": 0.6250099326850596
            }
          },
          "dirhit": 66.66666666666666,
          "rmse": 0.06703211475460308,
          "mape": 27249546.622794263,
          "nrmse": 1.7138360743988292,
          "mask_count": 21,
          "mask_pct": 72.41379310344827,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0
        }
      ],
      "avg_dirhit": 74.72222222222221,
      "avg_nrmse": 1.2497483068888802,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -2.0960582401870402,
          "rmse": 0.05420232828388526,
          "mape": 1.4623235170422775,
          "confidence": 0.30001883383536604
        },
        "lightgbm": {
          "raw_r2": -0.03336583832833088,
          "rmse": 0.03155071545500032,
          "mape": 1.8339498388303797,
          "confidence": 0.5979757356858724
        },
        "catboost": {
          "raw_r2": 0.0009036000929322034,
          "rmse": 0.031031690805924862,
          "mape": 1.6390368128372554,
          "confidence": 0.6257340602430261
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 987,
    "best_trial_seed": 1029,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "DAPGM_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 453,
            "test_end_idx": 483,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-12T00:00:00",
            "test_start": "2025-06-13T00:00:00",
            "test_end": "2025-07-25T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 483,
            "test_end_idx": 513,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-25T00:00:00",
            "test_start": "2025-07-28T00:00:00",
            "test_end": "2025-09-05T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 513,
            "test_end_idx": 543,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-05T00:00:00",
            "test_start": "2025-09-08T00:00:00",
            "test_end": "2025-10-17T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 543,
            "test_end_idx": 573,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-17T00:00:00",
            "test_start": "2025-10-20T00:00:00",
            "test_end": "2025-11-28T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:50:47.296000",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}