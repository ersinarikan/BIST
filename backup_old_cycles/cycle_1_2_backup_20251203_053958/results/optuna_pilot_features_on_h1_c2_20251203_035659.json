{
  "best_value": 85.0,
  "best_dirhit": 42.5,
  "best_params": {
    "enable_external_features": false,
    "enable_fingpt_features": true,
    "enable_yolo_features": false,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": false,
    "enable_fingpt": false,
    "model_choice": "all",
    "ml_adaptive_k_1d": 2.9268190851282734,
    "ml_pattern_weight_scale_1d": 1.4326184845163603,
    "enable_talib_patterns_short": false,
    "external_min_days": 55,
    "external_smooth_alpha": 0.48537092526297204,
    "smart_consensus_weight": 0.4278838416416589,
    "smart_performance_weight": 0.2607816141252968,
    "smart_sigma": 0.014196924273026042,
    "smart_weight_xgb": 0.9554815065905761,
    "smart_weight_lgbm": 1.1047382807909287,
    "smart_weight_cat": 1.0303404208914577,
    "fingpt_confidence_threshold": 0.39274742552840036,
    "xgb_n_estimators": 195,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.030589587780469548,
    "xgb_subsample": 0.8922861588599454,
    "xgb_colsample_bytree": 0.7099916018620916,
    "xgb_reg_alpha": 6.311555385105125e-05,
    "xgb_reg_lambda": 0.06116027320707622,
    "xgb_min_child_weight": 14,
    "xgb_gamma": 0.633000210895246,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 331,
    "lgb_n_estimators": 495,
    "lgb_max_depth": 4,
    "lgb_learning_rate": 0.1287977176049036,
    "lgb_num_leaves": 46,
    "lgb_subsample": 0.7666601757812486,
    "lgb_colsample_bytree": 0.7579030816724536,
    "lgb_reg_alpha": 0.05305034862289613,
    "lgb_reg_lambda": 0.22564936414774078,
    "lgb_min_data_in_leaf": 33,
    "lgb_feature_fraction_bynode": 0.5418414465406254,
    "lgb_bagging_freq": 1,
    "lgb_min_gain_to_split": 0.38008193185163697,
    "cat_iterations": 216,
    "cat_depth": 4,
    "cat_learning_rate": 0.0441450297246532,
    "cat_l2_leaf_reg": 9.299448715451671,
    "cat_subsample": 0.9069506515807686,
    "cat_rsm": 0.5171414627406264,
    "cat_border_count": 158,
    "cat_random_strength": 0.13759195928674375,
    "cat_leaf_estimation_iterations": 11,
    "cat_bootstrap_type": "MVS"
  },
  "best_trial": {
    "number": 1165,
    "value": 23.684165048519993,
    "state": "1"
  },
  "best_trial_number": 1165,
  "best_trial_seed": 1207,
  "n_trials": 1167,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_EGPRO_h1_c2",
  "symbols": [
    "EGPRO"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": false,
    "enable_fingpt_features": true,
    "enable_yolo_features": false,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": false,
    "enable_fingpt": false,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_adaptive_k_1d": 2.9268190851282734,
    "ml_pattern_weight_scale_1d": 1.4326184845163603,
    "external_min_days": 55,
    "external_smooth_alpha": 0.48537092526297204,
    "smart_consensus_weight": 0.4278838416416589,
    "smart_performance_weight": 0.2607816141252968,
    "smart_sigma": 0.014196924273026042,
    "smart_weight_xgb": 0.9554815065905761,
    "smart_weight_lgbm": 1.1047382807909287,
    "smart_weight_cat": 1.0303404208914577,
    "fingpt_confidence_threshold": 0.39274742552840036
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 195,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.030589587780469548,
    "xgb_subsample": 0.8922861588599454,
    "xgb_colsample_bytree": 0.7099916018620916,
    "xgb_reg_alpha": 6.311555385105125e-05,
    "xgb_reg_lambda": 0.06116027320707622,
    "xgb_min_child_weight": 14,
    "xgb_gamma": 0.633000210895246,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 331,
    "lgb_n_estimators": 495,
    "lgb_max_depth": 4,
    "lgb_learning_rate": 0.1287977176049036,
    "lgb_num_leaves": 46,
    "lgb_subsample": 0.7666601757812486,
    "lgb_colsample_bytree": 0.7579030816724536,
    "lgb_reg_alpha": 0.05305034862289613,
    "lgb_reg_lambda": 0.22564936414774078,
    "lgb_min_data_in_leaf": 33,
    "lgb_feature_fraction_bynode": 0.5418414465406254,
    "lgb_bagging_freq": 1,
    "lgb_min_gain_to_split": 0.38008193185163697,
    "cat_iterations": 216,
    "cat_depth": 4,
    "cat_learning_rate": 0.0441450297246532,
    "cat_l2_leaf_reg": 9.299448715451671,
    "cat_subsample": 0.9069506515807686,
    "cat_rsm": 0.5171414627406264,
    "cat_border_count": 158,
    "cat_random_strength": 0.13759195928674375,
    "cat_leaf_estimation_iterations": 11,
    "cat_bootstrap_type": "MVS"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "0",
    "ENABLE_FINGPT_FEATURES": "1",
    "ENABLE_YOLO_FEATURES": "0",
    "ML_USE_DIRECTIONAL_LOSS": "0",
    "ENABLE_SEED_BAGGING": "0",
    "ENABLE_TALIB_PATTERNS": "0",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "0",
    "ENABLE_FINGPT": "0",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "EGPRO_1d": {
      "symbol": "EGPRO",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 455,
          "test_days": 30,
          "train_end_idx": 455,
          "test_end_idx": 485,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-16T00:00:00",
          "test_start": "2025-06-17T00:00:00",
          "test_end": "2025-07-29T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.025570360529706182,
              "rmse": 0.02913082840018359,
              "mape": 1.676576166955398,
              "confidence": 0.6042523362932595
            },
            "lightgbm": {
              "raw_r2": -0.020776812048700927,
              "rmse": 0.029115806212667947,
              "mape": 1.7468979902130037,
              "confidence": 0.6081340054906008
            },
            "catboost": {
              "raw_r2": -0.023848459556608786,
              "rmse": 0.02918683519516056,
              "mape": 1.7441299240525763,
              "confidence": 0.6056460535487339
            }
          },
          "dirhit": 0.0,
          "rmse": 0.018991724032549978,
          "mape": 114.7155886107097,
          "nrmse": 1.044763908152795,
          "mask_count": 4,
          "mask_pct": 13.793103448275861,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.025570360529706182,
              "lightgbm": -0.020776812048700927,
              "catboost": -0.023848459556608786
            },
            "ensemble_weights": {
              "xgboost": 0.5567688691078551,
              "lightgbm": 0.2981571050664088,
              "catboost": 0.145074025825736
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 485,
          "test_days": 30,
          "train_end_idx": 485,
          "test_end_idx": 515,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-29T00:00:00",
          "test_start": "2025-07-30T00:00:00",
          "test_end": "2025-09-09T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.01548456102754899,
              "rmse": 0.027809731539185593,
              "mape": 1.669600341334626,
              "confidence": 0.6124250750173701
            },
            "lightgbm": {
              "raw_r2": -0.010871559857365876,
              "rmse": 0.027757450556378013,
              "mape": 1.7115116956988212,
              "confidence": 0.616169031965685
            },
            "catboost": {
              "raw_r2": -0.011770981857156379,
              "rmse": 0.02782742504041065,
              "mape": 1.6954866453212336,
              "confidence": 0.6154388369913947
            }
          },
          "dirhit": 100.0,
          "rmse": 0.029952317196972784,
          "mape": 1329270.4983775814,
          "nrmse": 1.0121750122777355,
          "mask_count": 5,
          "mask_pct": 17.24137931034483,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.01548456102754899,
              "lightgbm": -0.010871559857365876,
              "catboost": -0.011770981857156379
            },
            "ensemble_weights": {
              "xgboost": 0.7256122821129444,
              "lightgbm": 0.1420564226794058,
              "catboost": 0.13233129520764983
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 515,
          "test_days": 30,
          "train_end_idx": 515,
          "test_end_idx": 545,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-09T00:00:00",
          "test_start": "2025-09-10T00:00:00",
          "test_end": "2025-10-21T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.008863723483625444,
              "rmse": 0.028036355503353854,
              "mape": 1.6904617550897292,
              "confidence": 0.6177994032125655
            },
            "lightgbm": {
              "raw_r2": -0.005851007995003155,
              "rmse": 0.027995658265533106,
              "mape": 1.7458747665930172,
              "confidence": 0.6202463950332087
            },
            "catboost": {
              "raw_r2": 0.0014208913096926217,
              "rmse": 0.02792106668992003,
              "mape": 1.6733922445628977,
              "confidence": 0.626154469333306
            }
          },
          "dirhit": 70.0,
          "rmse": 0.03134326388539992,
          "mape": 116.13407021402948,
          "nrmse": 0.9281245989142737,
          "mask_count": 10,
          "mask_pct": 34.48275862068966,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.008863723483625444,
              "lightgbm": -0.005851007995003155,
              "catboost": 0.0014208913096926217
            },
            "ensemble_weights": {
              "xgboost": 0.11680030609548801,
              "lightgbm": 0.13524938572628875,
              "catboost": 0.7479503081782234
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 545,
          "test_days": 30,
          "train_end_idx": 545,
          "test_end_idx": 575,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-21T00:00:00",
          "test_start": "2025-10-22T00:00:00",
          "test_end": "2025-12-02T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.008139733702688945,
              "rmse": 0.028014109982780942,
              "mape": 1.718601248225748,
              "confidence": 0.6183873790933453
            },
            "lightgbm": {
              "raw_r2": -0.005562902969478071,
              "rmse": 0.027966164452261237,
              "mape": 1.7533228662986466,
              "confidence": 0.6204804327127704
            },
            "catboost": {
              "raw_r2": 0.005213226506853704,
              "rmse": 0.027800943218581606,
              "mape": 1.677929902141558,
              "confidence": 0.629235506723991
            }
          },
          "dirhit": 0.0,
          "rmse": 0.021056242746221223,
          "mape": 2578167.925541465,
          "nrmse": 1.0588264483085312,
          "mask_count": 2,
          "mask_pct": 6.896551724137931,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.008139733702688945,
              "lightgbm": -0.005562902969478071,
              "catboost": 0.005213226506853704
            },
            "ensemble_weights": {
              "xgboost": 0.7257178449306453,
              "lightgbm": 0.14155077769674856,
              "catboost": 0.13273137737260618
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 42.5,
      "avg_nrmse": 1.0109724919133338,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.01451459468589239,
          "rmse": 0.028247756356375997,
          "mape": 1.6888098779013754,
          "confidence": 0.6132160484041351
        },
        "lightgbm": {
          "raw_r2": -0.010765570717637006,
          "rmse": 0.028208769871710074,
          "mape": 1.7394018297008722,
          "confidence": 0.6162574663005662
        },
        "catboost": {
          "raw_r2": -0.00724633089930471,
          "rmse": 0.028184067536018213,
          "mape": 1.6977346790195662,
          "confidence": 0.6191187166493564
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 1165,
    "best_trial_seed": 1207,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "EGPRO_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 455,
            "test_end_idx": 485,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-16T00:00:00",
            "test_start": "2025-06-17T00:00:00",
            "test_end": "2025-07-29T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 485,
            "test_end_idx": 515,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-29T00:00:00",
            "test_start": "2025-07-30T00:00:00",
            "test_end": "2025-09-09T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 515,
            "test_end_idx": 545,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-09T00:00:00",
            "test_start": "2025-09-10T00:00:00",
            "test_end": "2025-10-21T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 545,
            "test_end_idx": 575,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-21T00:00:00",
            "test_start": "2025-10-22T00:00:00",
            "test_end": "2025-12-02T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:56:59.163812",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}