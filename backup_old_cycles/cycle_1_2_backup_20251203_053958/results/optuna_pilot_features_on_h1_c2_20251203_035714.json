{
  "best_value": 90.0,
  "best_dirhit": 90.0,
  "best_params": {
    "enable_external_features": true,
    "enable_fingpt_features": false,
    "enable_yolo_features": false,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": true,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "model_choice": "all",
    "ml_adaptive_k_1d": 2.5572407638586014,
    "ml_pattern_weight_scale_1d": 1.6719139325205672,
    "enable_talib_patterns_short": false,
    "external_min_days": 44,
    "external_smooth_alpha": 0.061428731205760014,
    "regime_scale_low": 0.9106411129106377,
    "regime_scale_high": 1.1305028737121001,
    "smart_consensus_weight": 0.46188069481655875,
    "smart_performance_weight": 0.4351282928377339,
    "smart_sigma": 0.009701268029181526,
    "smart_weight_xgb": 1.4021811810467033,
    "smart_weight_lgbm": 1.0625080475048836,
    "smart_weight_cat": 1.107377251412157,
    "xgb_n_estimators": 496,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.07634374297044152,
    "xgb_subsample": 0.593350907971375,
    "xgb_colsample_bytree": 0.5613812305440273,
    "xgb_reg_alpha": 0.00014038928265176355,
    "xgb_reg_lambda": 1.0962031227106588,
    "xgb_min_child_weight": 12,
    "xgb_gamma": 0.0010525383230451575,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 221,
    "lgb_n_estimators": 250,
    "lgb_max_depth": 5,
    "lgb_learning_rate": 0.010039632232574308,
    "lgb_num_leaves": 28,
    "lgb_subsample": 0.6757096345192216,
    "lgb_colsample_bytree": 0.73798059300304,
    "lgb_reg_alpha": 0.007842943326876552,
    "lgb_reg_lambda": 0.3298869919109607,
    "lgb_min_data_in_leaf": 55,
    "lgb_feature_fraction_bynode": 0.8235441273823381,
    "lgb_bagging_freq": 8,
    "lgb_min_gain_to_split": 0.4032679823379268,
    "cat_iterations": 247,
    "cat_depth": 8,
    "cat_learning_rate": 0.18708821321216693,
    "cat_l2_leaf_reg": 4.87391545384574,
    "cat_subsample": 0.7108340536153541,
    "cat_rsm": 0.8851543884278211,
    "cat_border_count": 22,
    "cat_random_strength": 2.4430668129986612,
    "cat_leaf_estimation_iterations": 10,
    "cat_bootstrap_type": "Bayesian"
  },
  "best_trial": {
    "number": 131,
    "value": 56.98201578373921,
    "state": "1"
  },
  "best_trial_number": 131,
  "best_trial_seed": 173,
  "n_trials": 1113,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_EKGYO_h1_c2",
  "symbols": [
    "EKGYO"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": true,
    "enable_fingpt_features": false,
    "enable_yolo_features": false,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": true,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_adaptive_k_1d": 2.5572407638586014,
    "ml_pattern_weight_scale_1d": 1.6719139325205672,
    "external_min_days": 44,
    "external_smooth_alpha": 0.061428731205760014,
    "regime_scale_low": 0.9106411129106377,
    "regime_scale_high": 1.1305028737121001,
    "smart_consensus_weight": 0.46188069481655875,
    "smart_performance_weight": 0.4351282928377339,
    "smart_sigma": 0.009701268029181526,
    "smart_weight_xgb": 1.4021811810467033,
    "smart_weight_lgbm": 1.0625080475048836,
    "smart_weight_cat": 1.107377251412157
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 496,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.07634374297044152,
    "xgb_subsample": 0.593350907971375,
    "xgb_colsample_bytree": 0.5613812305440273,
    "xgb_reg_alpha": 0.00014038928265176355,
    "xgb_reg_lambda": 1.0962031227106588,
    "xgb_min_child_weight": 12,
    "xgb_gamma": 0.0010525383230451575,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 221,
    "lgb_n_estimators": 250,
    "lgb_max_depth": 5,
    "lgb_learning_rate": 0.010039632232574308,
    "lgb_num_leaves": 28,
    "lgb_subsample": 0.6757096345192216,
    "lgb_colsample_bytree": 0.73798059300304,
    "lgb_reg_alpha": 0.007842943326876552,
    "lgb_reg_lambda": 0.3298869919109607,
    "lgb_min_data_in_leaf": 55,
    "lgb_feature_fraction_bynode": 0.8235441273823381,
    "lgb_bagging_freq": 8,
    "lgb_min_gain_to_split": 0.4032679823379268,
    "cat_iterations": 247,
    "cat_depth": 8,
    "cat_learning_rate": 0.18708821321216693,
    "cat_l2_leaf_reg": 4.87391545384574,
    "cat_subsample": 0.7108340536153541,
    "cat_rsm": 0.8851543884278211,
    "cat_border_count": 22,
    "cat_random_strength": 2.4430668129986612,
    "cat_leaf_estimation_iterations": 10,
    "cat_bootstrap_type": "Bayesian"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "1",
    "ENABLE_FINGPT_FEATURES": "0",
    "ENABLE_YOLO_FEATURES": "0",
    "ML_USE_DIRECTIONAL_LOSS": "0",
    "ENABLE_SEED_BAGGING": "0",
    "ENABLE_TALIB_PATTERNS": "1",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "1",
    "ENABLE_FINGPT": "1",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "EKGYO_1d": {
      "symbol": "EKGYO",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 452,
          "test_days": 30,
          "train_end_idx": 452,
          "test_end_idx": 482,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-12T00:00:00",
          "test_start": "2025-06-13T00:00:00",
          "test_end": "2025-07-25T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": 0.021008633833408785,
              "rmse": 0.02925953611893962,
              "mape": 1.5903788043657758,
              "confidence": 0.6420538367739757
            },
            "lightgbm": {
              "raw_r2": -0.0003248149975748997,
              "rmse": 0.029580066347184887,
              "mape": 1.7899776696003316,
              "confidence": 0.6247360878724787
            },
            "catboost": {
              "raw_r2": 0.026574726649080782,
              "rmse": 0.02918683565520209,
              "mape": 1.6659062413275538,
              "confidence": 0.6465602534866948
            }
          },
          "dirhit": null,
          "rmse": 0.030713687463343815,
          "mape": 89.09259409591608,
          "nrmse": 1.0415598772624288,
          "mask_count": 7,
          "mask_pct": 24.137931034482758,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": 0.021008633833408785,
              "lightgbm": -0.0003248149975748997,
              "catboost": 0.026574726649080782
            },
            "ensemble_weights": {
              "xgboost": 0.7297960324147544,
              "lightgbm": 0.13113792850724407,
              "catboost": 0.13906603907800147
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 482,
          "test_days": 30,
          "train_end_idx": 482,
          "test_end_idx": 512,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-25T00:00:00",
          "test_start": "2025-07-28T00:00:00",
          "test_end": "2025-09-05T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": 0.010924210590516403,
              "rmse": 0.029603865238495886,
              "mape": 1.6190711376244722,
              "confidence": 0.6338737150170961
            },
            "lightgbm": {
              "raw_r2": -0.0012070340897110121,
              "rmse": 0.0298191806690072,
              "mape": 1.7155106876202544,
              "confidence": 0.6240192877788379
            },
            "catboost": {
              "raw_r2": -0.008519555197759673,
              "rmse": 0.029913569549690527,
              "mape": 1.6824663276534706,
              "confidence": 0.6180789079376385
            }
          },
          "dirhit": null,
          "rmse": 0.024019051600889522,
          "mape": 8065067.127514338,
          "nrmse": 1.0367464850588746,
          "mask_count": 7,
          "mask_pct": 24.137931034482758,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": 0.010924210590516403,
              "lightgbm": -0.0012070340897110121,
              "catboost": -0.008519555197759673
            },
            "ensemble_weights": {
              "xgboost": 0.2026070157800318,
              "lightgbm": 0.6389314765927624,
              "catboost": 0.15846150762720587
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 512,
          "test_days": 30,
          "train_end_idx": 512,
          "test_end_idx": 542,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-05T00:00:00",
          "test_start": "2025-09-08T00:00:00",
          "test_end": "2025-10-17T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": 0.0244204003116002,
              "rmse": 0.02894544315145139,
              "mape": 1.5687123457434533,
              "confidence": 0.6448169606138094
            },
            "lightgbm": {
              "raw_r2": -0.0019396624089432397,
              "rmse": 0.029334471189729008,
              "mape": 1.7316206053386953,
              "confidence": 0.6234240366452801
            },
            "catboost": {
              "raw_r2": 0.00010241422906265285,
              "rmse": 0.029302042811969176,
              "mape": 1.6588785011963554,
              "confidence": 0.625083211559295
            }
          },
          "dirhit": 90.0,
          "rmse": 0.03178585438557242,
          "mape": 3103041.858207196,
          "nrmse": 0.9692375413932564,
          "mask_count": 10,
          "mask_pct": 34.48275862068966,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": 0.0244204003116002,
              "lightgbm": -0.0019396624089432397,
              "catboost": 0.00010241422906265285
            },
            "ensemble_weights": {
              "xgboost": 0.19912943862852944,
              "lightgbm": 0.14891537811335256,
              "catboost": 0.651955183258118
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 542,
          "test_days": 30,
          "train_end_idx": 542,
          "test_end_idx": 572,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-17T00:00:00",
          "test_start": "2025-10-20T00:00:00",
          "test_end": "2025-11-28T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": 0.015678093768361934,
              "rmse": 0.029656816788808483,
              "mape": 1.5849864030420615,
              "confidence": 0.6377319319746757
            },
            "lightgbm": {
              "raw_r2": -0.001898898967846489,
              "rmse": 0.02994477781994963,
              "mape": 1.7531310552892359,
              "confidence": 0.6234571561786342
            },
            "catboost": {
              "raw_r2": -0.006350758630362756,
              "rmse": 0.029998555207193613,
              "mape": 1.6592912440608085,
              "confidence": 0.6198404421388473
            }
          },
          "dirhit": 90.0,
          "rmse": 0.02144965680934684,
          "mape": 3601680.699236739,
          "nrmse": 0.9644455737926314,
          "mask_count": 10,
          "mask_pct": 34.48275862068966,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": 0.015678093768361934,
              "lightgbm": -0.001898898967846489,
              "catboost": -0.006350758630362756
            },
            "ensemble_weights": {
              "xgboost": 0.19886029551016698,
              "lightgbm": 0.15365890843819804,
              "catboost": 0.647480796051635
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 90.0,
      "avg_nrmse": 1.0029973693767977,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": 0.01800783462597183,
          "rmse": 0.029366415324423845,
          "mape": 1.5907871726939407,
          "confidence": 0.6396191110948892
        },
        "lightgbm": {
          "raw_r2": -0.0013426026160189102,
          "rmse": 0.029669624006467683,
          "mape": 1.7475600044621293,
          "confidence": 0.6239091421188077
        },
        "catboost": {
          "raw_r2": 0.002951706762505251,
          "rmse": 0.029600250806013848,
          "mape": 1.666635578559547,
          "confidence": 0.6273907037806189
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 131,
    "best_trial_seed": 173,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "EKGYO_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 452,
            "test_end_idx": 482,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-12T00:00:00",
            "test_start": "2025-06-13T00:00:00",
            "test_end": "2025-07-25T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 482,
            "test_end_idx": 512,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-25T00:00:00",
            "test_start": "2025-07-28T00:00:00",
            "test_end": "2025-09-05T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 512,
            "test_end_idx": 542,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-05T00:00:00",
            "test_start": "2025-09-08T00:00:00",
            "test_end": "2025-10-17T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 542,
            "test_end_idx": 572,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-17T00:00:00",
            "test_start": "2025-10-20T00:00:00",
            "test_end": "2025-11-28T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:57:13.981925",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}