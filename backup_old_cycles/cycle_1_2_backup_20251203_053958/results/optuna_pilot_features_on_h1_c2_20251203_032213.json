{
  "best_value": 81.36363636363637,
  "best_dirhit": 81.36363636363637,
  "best_params": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": false,
    "enable_directional_loss": true,
    "enable_seed_bagging": true,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "model_choice": "all",
    "ml_loss_mse_weight": 0.27389797619275225,
    "ml_loss_threshold": 0.001222747914566301,
    "ml_dir_penalty": 4.814374355801228,
    "n_seeds": 4,
    "ml_adaptive_k_1d": 2.6110514011789174,
    "ml_pattern_weight_scale_1d": 0.6024745538618581,
    "enable_talib_patterns_short": false,
    "external_min_days": 47,
    "external_smooth_alpha": 0.16675150929552873,
    "regime_scale_low": 0.9097041542920551,
    "regime_scale_high": 1.0321367456552666,
    "smart_consensus_weight": 0.30030082778561257,
    "smart_performance_weight": 0.32616604936685034,
    "smart_sigma": 0.0045134232451989964,
    "smart_weight_xgb": 1.4860173335031588,
    "smart_weight_lgbm": 0.6999250814093028,
    "smart_weight_cat": 0.7319206491988831,
    "xgb_n_estimators": 517,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.12650426121934133,
    "xgb_subsample": 0.6544956676400083,
    "xgb_colsample_bytree": 0.5624559117474683,
    "xgb_reg_alpha": 2.656478571017764e-05,
    "xgb_reg_lambda": 0.4015177315634893,
    "xgb_min_child_weight": 8,
    "xgb_gamma": 0.0235893404523332,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 496,
    "lgb_n_estimators": 129,
    "lgb_max_depth": 3,
    "lgb_learning_rate": 0.01359277953275627,
    "lgb_num_leaves": 14,
    "lgb_subsample": 0.5842771985881374,
    "lgb_colsample_bytree": 0.6692417408167102,
    "lgb_reg_alpha": 0.0004484012558468287,
    "lgb_reg_lambda": 0.005184261239603071,
    "lgb_min_data_in_leaf": 40,
    "lgb_feature_fraction_bynode": 0.6161451265724226,
    "lgb_bagging_freq": 1,
    "lgb_min_gain_to_split": 0.05409512485123377,
    "cat_iterations": 260,
    "cat_depth": 7,
    "cat_learning_rate": 0.012619489377794082,
    "cat_l2_leaf_reg": 3.4759768924681884,
    "cat_subsample": 0.5502419733285387,
    "cat_rsm": 0.771439844849755,
    "cat_border_count": 147,
    "cat_random_strength": 0.26777953197433135,
    "cat_leaf_estimation_iterations": 2,
    "cat_bootstrap_type": "Bayesian"
  },
  "best_trial": {
    "number": 803,
    "value": 50.895154315390194,
    "state": "1"
  },
  "best_trial_number": 803,
  "best_trial_seed": 845,
  "n_trials": 1446,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_BAYRK_h1_c2",
  "symbols": [
    "BAYRK"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": false,
    "enable_directional_loss": true,
    "enable_seed_bagging": true,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_loss_mse_weight": 0.27389797619275225,
    "ml_loss_threshold": 0.001222747914566301,
    "ml_dir_penalty": 4.814374355801228,
    "n_seeds": 4,
    "ml_adaptive_k_1d": 2.6110514011789174,
    "ml_pattern_weight_scale_1d": 0.6024745538618581,
    "external_min_days": 47,
    "external_smooth_alpha": 0.16675150929552873,
    "regime_scale_low": 0.9097041542920551,
    "regime_scale_high": 1.0321367456552666,
    "smart_consensus_weight": 0.30030082778561257,
    "smart_performance_weight": 0.32616604936685034,
    "smart_sigma": 0.0045134232451989964,
    "smart_weight_xgb": 1.4860173335031588,
    "smart_weight_lgbm": 0.6999250814093028,
    "smart_weight_cat": 0.7319206491988831
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 517,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.12650426121934133,
    "xgb_subsample": 0.6544956676400083,
    "xgb_colsample_bytree": 0.5624559117474683,
    "xgb_reg_alpha": 2.656478571017764e-05,
    "xgb_reg_lambda": 0.4015177315634893,
    "xgb_min_child_weight": 8,
    "xgb_gamma": 0.0235893404523332,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 496,
    "lgb_n_estimators": 129,
    "lgb_max_depth": 3,
    "lgb_learning_rate": 0.01359277953275627,
    "lgb_num_leaves": 14,
    "lgb_subsample": 0.5842771985881374,
    "lgb_colsample_bytree": 0.6692417408167102,
    "lgb_reg_alpha": 0.0004484012558468287,
    "lgb_reg_lambda": 0.005184261239603071,
    "lgb_min_data_in_leaf": 40,
    "lgb_feature_fraction_bynode": 0.6161451265724226,
    "lgb_bagging_freq": 1,
    "lgb_min_gain_to_split": 0.05409512485123377,
    "cat_iterations": 260,
    "cat_depth": 7,
    "cat_learning_rate": 0.012619489377794082,
    "cat_l2_leaf_reg": 3.4759768924681884,
    "cat_subsample": 0.5502419733285387,
    "cat_rsm": 0.771439844849755,
    "cat_border_count": 147,
    "cat_random_strength": 0.26777953197433135,
    "cat_leaf_estimation_iterations": 2,
    "cat_bootstrap_type": "Bayesian"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "0",
    "ENABLE_FINGPT_FEATURES": "0",
    "ENABLE_YOLO_FEATURES": "0",
    "ML_USE_DIRECTIONAL_LOSS": "1",
    "ENABLE_SEED_BAGGING": "1",
    "ENABLE_TALIB_PATTERNS": "0",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "1",
    "ENABLE_FINGPT": "1",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "BAYRK_1d": {
      "symbol": "BAYRK",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 452,
          "test_days": 30,
          "train_end_idx": 452,
          "test_end_idx": 482,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-12T00:00:00",
          "test_start": "2025-06-13T00:00:00",
          "test_end": "2025-07-25T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.18735572477688991,
              "rmse": 0.0471016267852206,
              "mape": 1.4707820857907625,
              "confidence": 0.48300847797461066
            },
            "lightgbm": {
              "raw_r2": -0.026724721447043482,
              "rmse": 0.04368312097428356,
              "mape": 1.618158152696525,
              "confidence": 0.6033184151044031
            },
            "catboost": {
              "raw_r2": 0.007367281900546918,
              "rmse": 0.043017617017073524,
              "mape": 1.6061716812998128,
              "confidence": 0.6309852397680064
            }
          },
          "dirhit": null,
          "rmse": 0.04242234269134335,
          "mape": 6976732.783142606,
          "nrmse": 1.0351586958233514,
          "mask_count": 5,
          "mask_pct": 17.24137931034483,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.18735572477688991,
              "lightgbm": -0.026724721447043482,
              "catboost": 0.007367281900546918
            },
            "ensemble_weights": {
              "xgboost": 0.28587457692725,
              "lightgbm": 0.145909575959706,
              "catboost": 0.5682158471130441
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 482,
          "test_days": 30,
          "train_end_idx": 482,
          "test_end_idx": 512,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-25T00:00:00",
          "test_start": "2025-07-28T00:00:00",
          "test_end": "2025-09-05T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.12202181240589678,
              "rmse": 0.045072826764109536,
              "mape": 1.5053119974488007,
              "confidence": 0.5288223078683312
            },
            "lightgbm": {
              "raw_r2": -0.03628684257506672,
              "rmse": 0.04244665621414558,
              "mape": 1.639561126076173,
              "confidence": 0.595597552919092
            },
            "catboost": {
              "raw_r2": -0.004760317070660565,
              "rmse": 0.041836983479856246,
              "mape": 1.5877436333091806,
              "confidence": 0.6211324249651202
            }
          },
          "dirhit": null,
          "rmse": 0.0349023784094337,
          "mape": 148.97186665159262,
          "nrmse": 1.0219862790726788,
          "mask_count": 8,
          "mask_pct": 27.586206896551722,
          "low_support": true,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.12202181240589678,
              "lightgbm": -0.03628684257506672,
              "catboost": -0.004760317070660565
            },
            "ensemble_weights": {
              "xgboost": 0.29761364431948184,
              "lightgbm": 0.5469490097764474,
              "catboost": 0.1554373459040707
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 512,
          "test_days": 30,
          "train_end_idx": 512,
          "test_end_idx": 542,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-05T00:00:00",
          "test_start": "2025-09-08T00:00:00",
          "test_end": "2025-10-17T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.27691729434807033,
              "rmse": 0.04703947287152835,
              "mape": 1.6213288905560947,
              "confidence": 0.430177711505753
            },
            "lightgbm": {
              "raw_r2": -0.04735165102185083,
              "rmse": 0.04177032741176703,
              "mape": 1.6326264522201117,
              "confidence": 0.586705498153762
            },
            "catboost": {
              "raw_r2": -0.03169411752265905,
              "rmse": 0.04150006339993982,
              "mape": 1.5865353360654282,
              "confidence": 0.5993022857527253
            }
          },
          "dirhit": 72.72727272727273,
          "rmse": 0.045510559753739056,
          "mape": 121.89790013845447,
          "nrmse": 0.9874854242353309,
          "mask_count": 11,
          "mask_pct": 37.93103448275862,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.27691729434807033,
              "lightgbm": -0.04735165102185083,
              "catboost": -0.03169411752265905
            },
            "ensemble_weights": {
              "xgboost": 0.2809119893737331,
              "lightgbm": 0.14840464783300847,
              "catboost": 0.5706833627932584
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 542,
          "test_days": 30,
          "train_end_idx": 542,
          "test_end_idx": 572,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-17T00:00:00",
          "test_start": "2025-10-20T00:00:00",
          "test_end": "2025-11-28T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.3060332222010158,
              "rmse": 0.0474506273943086,
              "mape": 1.5084810980593621,
              "confidence": 0.4156800989915215
            },
            "lightgbm": {
              "raw_r2": -0.04425461051402698,
              "rmse": 0.041454067780736646,
              "mape": 1.6317241404939824,
              "confidence": 0.5891891235028461
            },
            "catboost": {
              "raw_r2": -0.044139238553145464,
              "rmse": 0.041459614969458616,
              "mape": 1.6270322897507579,
              "confidence": 0.5892817280448168
            }
          },
          "dirhit": 90.0,
          "rmse": 0.05415803361433432,
          "mape": 3337095.44654703,
          "nrmse": 0.9949636936388173,
          "mask_count": 10,
          "mask_pct": 34.48275862068966,
          "low_support": false,
          "min_mask_count": 10,
          "min_mask_pct": 5.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.3060332222010158,
              "lightgbm": -0.04425461051402698,
              "catboost": -0.044139238553145464
            },
            "ensemble_weights": {
              "xgboost": 0.7853995060181784,
              "lightgbm": 0.10489945659888143,
              "catboost": 0.10970103738294017
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 81.36363636363637,
      "avg_nrmse": 1.0098985231925446,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.2230820134329682,
          "rmse": 0.04666613845379177,
          "mape": 1.526476017963755,
          "confidence": 0.4644221490850541
        },
        "lightgbm": {
          "raw_r2": -0.03865445638949701,
          "rmse": 0.04233854309523321,
          "mape": 1.630517467871698,
          "confidence": 0.5937026474200258
        },
        "catboost": {
          "raw_r2": -0.01830659781147954,
          "rmse": 0.041953569716582054,
          "mape": 1.6018707351062949,
          "confidence": 0.6101754196326672
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 803,
    "best_trial_seed": 845,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "BAYRK_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 452,
            "test_end_idx": 482,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-12T00:00:00",
            "test_start": "2025-06-13T00:00:00",
            "test_end": "2025-07-25T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 482,
            "test_end_idx": 512,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-25T00:00:00",
            "test_start": "2025-07-28T00:00:00",
            "test_end": "2025-09-05T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 512,
            "test_end_idx": 542,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-05T00:00:00",
            "test_start": "2025-09-08T00:00:00",
            "test_end": "2025-10-17T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 542,
            "test_end_idx": 572,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-17T00:00:00",
            "test_start": "2025-10-20T00:00:00",
            "test_end": "2025-11-28T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:22:13.526697",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}