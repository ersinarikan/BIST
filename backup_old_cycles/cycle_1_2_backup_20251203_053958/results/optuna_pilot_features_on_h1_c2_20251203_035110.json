{
  "best_value": 84.52380952380952,
  "best_dirhit": 56.84523809523809,
  "best_params": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": true,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": true,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": false,
    "enable_fingpt": false,
    "model_choice": "all",
    "ml_adaptive_k_1d": 2.583577419403117,
    "ml_pattern_weight_scale_1d": 0.7070534060794947,
    "enable_talib_patterns_short": false,
    "external_min_days": 59,
    "external_smooth_alpha": 0.07724184814693351,
    "yolo_min_conf": 0.5326901866352555,
    "smart_consensus_weight": 0.42312992175673547,
    "smart_performance_weight": 0.37091894897947464,
    "smart_sigma": 0.005369132511852683,
    "smart_weight_xgb": 0.9720403792159608,
    "smart_weight_lgbm": 1.4996907666957644,
    "smart_weight_cat": 0.5505884490157349,
    "xgb_n_estimators": 594,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.04163498227473657,
    "xgb_subsample": 0.7725443602805958,
    "xgb_colsample_bytree": 0.5435800185782155,
    "xgb_reg_alpha": 1.4745326563018972e-05,
    "xgb_reg_lambda": 1.810439436819486,
    "xgb_min_child_weight": 11,
    "xgb_gamma": 0.07589673308261267,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 349,
    "lgb_n_estimators": 130,
    "lgb_max_depth": 7,
    "lgb_learning_rate": 0.01157317153591935,
    "lgb_num_leaves": 33,
    "lgb_subsample": 0.6576738889167403,
    "lgb_colsample_bytree": 0.6628838920304437,
    "lgb_reg_alpha": 0.00911070508074941,
    "lgb_reg_lambda": 0.00012504346081470842,
    "lgb_min_data_in_leaf": 86,
    "lgb_feature_fraction_bynode": 0.6952924235222805,
    "lgb_bagging_freq": 3,
    "lgb_min_gain_to_split": 0.9611391879464459,
    "cat_iterations": 120,
    "cat_depth": 6,
    "cat_learning_rate": 0.13596485868352046,
    "cat_l2_leaf_reg": 9.81664302065177,
    "cat_subsample": 0.6232197065387421,
    "cat_rsm": 0.7697384224283457,
    "cat_border_count": 45,
    "cat_random_strength": 1.3890923159289987,
    "cat_leaf_estimation_iterations": 4,
    "cat_bootstrap_type": "MVS"
  },
  "best_trial": {
    "number": 1405,
    "value": 33.61973637009187,
    "state": "1"
  },
  "best_trial_number": 1405,
  "best_trial_seed": 1447,
  "n_trials": 1405,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_DESA_h1_c2",
  "symbols": [
    "DESA"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": false,
    "enable_fingpt_features": false,
    "enable_yolo_features": true,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": true,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": false,
    "enable_fingpt": false,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_adaptive_k_1d": 2.583577419403117,
    "ml_pattern_weight_scale_1d": 0.7070534060794947,
    "external_min_days": 59,
    "external_smooth_alpha": 0.07724184814693351,
    "yolo_min_conf": 0.5326901866352555,
    "smart_consensus_weight": 0.42312992175673547,
    "smart_performance_weight": 0.37091894897947464,
    "smart_sigma": 0.005369132511852683,
    "smart_weight_xgb": 0.9720403792159608,
    "smart_weight_lgbm": 1.4996907666957644,
    "smart_weight_cat": 0.5505884490157349
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 594,
    "xgb_max_depth": 5,
    "xgb_learning_rate": 0.04163498227473657,
    "xgb_subsample": 0.7725443602805958,
    "xgb_colsample_bytree": 0.5435800185782155,
    "xgb_reg_alpha": 1.4745326563018972e-05,
    "xgb_reg_lambda": 1.810439436819486,
    "xgb_min_child_weight": 11,
    "xgb_gamma": 0.07589673308261267,
    "xgb_grow_policy": "depthwise",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 349,
    "lgb_n_estimators": 130,
    "lgb_max_depth": 7,
    "lgb_learning_rate": 0.01157317153591935,
    "lgb_num_leaves": 33,
    "lgb_subsample": 0.6576738889167403,
    "lgb_colsample_bytree": 0.6628838920304437,
    "lgb_reg_alpha": 0.00911070508074941,
    "lgb_reg_lambda": 0.00012504346081470842,
    "lgb_min_data_in_leaf": 86,
    "lgb_feature_fraction_bynode": 0.6952924235222805,
    "lgb_bagging_freq": 3,
    "lgb_min_gain_to_split": 0.9611391879464459,
    "cat_iterations": 120,
    "cat_depth": 6,
    "cat_learning_rate": 0.13596485868352046,
    "cat_l2_leaf_reg": 9.81664302065177,
    "cat_subsample": 0.6232197065387421,
    "cat_rsm": 0.7697384224283457,
    "cat_border_count": 45,
    "cat_random_strength": 1.3890923159289987,
    "cat_leaf_estimation_iterations": 4,
    "cat_bootstrap_type": "MVS"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "0",
    "ENABLE_FINGPT_FEATURES": "0",
    "ENABLE_YOLO_FEATURES": "1",
    "ML_USE_DIRECTIONAL_LOSS": "0",
    "ENABLE_SEED_BAGGING": "0",
    "ENABLE_TALIB_PATTERNS": "1",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "0",
    "ENABLE_FINGPT": "0",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "DESA_1d": {
      "symbol": "DESA",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 455,
          "test_days": 30,
          "train_end_idx": 455,
          "test_end_idx": 485,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-16T00:00:00",
          "test_start": "2025-06-17T00:00:00",
          "test_end": "2025-07-29T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.0064132053090652326,
              "rmse": 0.02846797092268167,
              "mape": 1.8236860862316493,
              "confidence": 0.619789717126189
            },
            "lightgbm": {
              "raw_r2": -0.006436087838670668,
              "rmse": 0.0284723304514409,
              "mape": 1.8420352146174013,
              "confidence": 0.6197711298663602
            },
            "catboost": {
              "raw_r2": -0.007337259213460475,
              "rmse": 0.028538712098662353,
              "mape": 1.8219332887007897,
              "confidence": 0.6190391454257922
            }
          },
          "dirhit": 85.71428571428571,
          "rmse": 0.019114255384454833,
          "mape": 38729.46058489871,
          "nrmse": 0.9682077486989494,
          "mask_count": 7,
          "mask_pct": 24.137931034482758,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.0064132053090652326,
              "lightgbm": -0.006436087838670668,
              "catboost": -0.007337259213460475
            },
            "ensemble_weights": {
              "xgboost": 0.11921602349601049,
              "lightgbm": 0.8132881739519311,
              "catboost": 0.06749580255205836
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 485,
          "test_days": 30,
          "train_end_idx": 485,
          "test_end_idx": 515,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-29T00:00:00",
          "test_start": "2025-07-30T00:00:00",
          "test_end": "2025-09-09T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.0033822712675212565,
              "rmse": 0.02795671810196075,
              "mape": 1.8448805945376832,
              "confidence": 0.6222519700881595
            },
            "lightgbm": {
              "raw_r2": -0.003315215137848974,
              "rmse": 0.027955595159157375,
              "mape": 1.8564467558094393,
              "confidence": 0.6223064493749568
            },
            "catboost": {
              "raw_r2": 0.036311145724171524,
              "rmse": 0.027505731619477246,
              "mape": 1.6419679881366513,
              "confidence": 0.6544220316652112
            }
          },
          "dirhit": 83.33333333333334,
          "rmse": 0.0265427291996933,
          "mape": 96.84618815486907,
          "nrmse": 1.059010138254802,
          "mask_count": 6,
          "mask_pct": 20.689655172413794,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.0033822712675212565,
              "lightgbm": -0.003315215137848974,
              "catboost": 0.036311145724171524
            },
            "ensemble_weights": {
              "xgboost": 0.19715694779276433,
              "lightgbm": 0.3041893876792288,
              "catboost": 0.49865366452800697
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 515,
          "test_days": 30,
          "train_end_idx": 515,
          "test_end_idx": 545,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-09T00:00:00",
          "test_start": "2025-09-10T00:00:00",
          "test_end": "2025-10-21T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.012381613003017359,
              "rmse": 0.02792648605132556,
              "mape": 1.8897150309295607,
              "confidence": 0.6149431512269142
            },
            "lightgbm": {
              "raw_r2": -0.012171246375143255,
              "rmse": 0.027920828838032322,
              "mape": 1.8791019418314152,
              "confidence": 0.6151139132097341
            },
            "catboost": {
              "raw_r2": -0.022383527901916517,
              "rmse": 0.028085145590450777,
              "mape": 1.8329019082064424,
              "confidence": 0.6068323429589833
            }
          },
          "dirhit": 33.33333333333333,
          "rmse": 0.03141453348921191,
          "mape": 120.70963176151804,
          "nrmse": 0.9986876652226335,
          "mask_count": 3,
          "mask_pct": 10.344827586206897,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.012381613003017359,
              "lightgbm": -0.012171246375143255,
              "catboost": -0.022383527901916517
            },
            "ensemble_weights": {
              "xgboost": 0.1193603902011522,
              "lightgbm": 0.8133681067241286,
              "catboost": 0.06727150307471913
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 545,
          "test_days": 30,
          "train_end_idx": 545,
          "test_end_idx": 575,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-21T00:00:00",
          "test_start": "2025-10-22T00:00:00",
          "test_end": "2025-12-02T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.012299937013984094,
              "rmse": 0.028185938236210004,
              "mape": 1.893772835954793,
              "confidence": 0.6150094498419395
            },
            "lightgbm": {
              "raw_r2": -0.01183674390256543,
              "rmse": 0.028174284206484296,
              "mape": 1.8828335762563648,
              "confidence": 0.6153854518319735
            },
            "catboost": {
              "raw_r2": -0.010579448685176166,
              "rmse": 0.028154820146374455,
              "mape": 1.786100403441355,
              "confidence": 0.616406201721913
            }
          },
          "dirhit": 25.0,
          "rmse": 0.028637665595207626,
          "mape": 441629.92045265925,
          "nrmse": 1.0887146455401397,
          "mask_count": 4,
          "mask_pct": 13.793103448275861,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.012299937013984094,
              "lightgbm": -0.01183674390256543,
              "catboost": -0.010579448685176166
            },
            "ensemble_weights": {
              "xgboost": 0.2616767894819369,
              "lightgbm": 0.6022015419674482,
              "catboost": 0.13612166855061475
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 56.84523809523809,
      "avg_nrmse": 1.0286550494291313,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.008619256648396986,
          "rmse": 0.028134278328044496,
          "mape": 1.8630136369134216,
          "confidence": 0.6179985720708006
        },
        "lightgbm": {
          "raw_r2": -0.008439823313557082,
          "rmse": 0.02813075966377872,
          "mape": 1.865104372128655,
          "confidence": 0.6181442360707561
        },
        "catboost": {
          "raw_r2": -0.0009972725190954082,
          "rmse": 0.028071102363741208,
          "mape": 1.7707258971213096,
          "confidence": 0.6241749304429749
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 1405,
    "best_trial_seed": 1447,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "DESA_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 455,
            "test_end_idx": 485,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-16T00:00:00",
            "test_start": "2025-06-17T00:00:00",
            "test_end": "2025-07-29T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 485,
            "test_end_idx": 515,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-29T00:00:00",
            "test_start": "2025-07-30T00:00:00",
            "test_end": "2025-09-09T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 515,
            "test_end_idx": 545,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-09T00:00:00",
            "test_start": "2025-09-10T00:00:00",
            "test_end": "2025-10-21T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 545,
            "test_end_idx": 575,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-21T00:00:00",
            "test_start": "2025-10-22T00:00:00",
            "test_end": "2025-12-02T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:51:10.448615",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}