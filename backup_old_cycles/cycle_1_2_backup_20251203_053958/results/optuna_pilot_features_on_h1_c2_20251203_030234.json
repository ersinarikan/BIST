{
  "best_value": 76.47058823529412,
  "best_dirhit": 54.90196078431372,
  "best_params": {
    "enable_external_features": true,
    "enable_fingpt_features": true,
    "enable_yolo_features": true,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "model_choice": "all",
    "ml_adaptive_k_1d": 1.4897905913312868,
    "ml_pattern_weight_scale_1d": 1.0225042118481937,
    "enable_talib_patterns_short": false,
    "external_min_days": 59,
    "external_smooth_alpha": 0.09901106639566218,
    "regime_scale_low": 0.8253009485111868,
    "regime_scale_high": 1.1648498753936765,
    "yolo_min_conf": 0.40737092865119007,
    "smart_consensus_weight": 0.5473248255680379,
    "smart_performance_weight": 0.4453875106874246,
    "smart_sigma": 0.005705792538190418,
    "smart_weight_xgb": 1.1334805378070167,
    "smart_weight_lgbm": 1.1343438500323675,
    "smart_weight_cat": 0.9844067563864479,
    "fingpt_confidence_threshold": 0.3626887821958939,
    "xgb_n_estimators": 322,
    "xgb_max_depth": 6,
    "xgb_learning_rate": 0.01243827993996266,
    "xgb_subsample": 0.8167693518124421,
    "xgb_colsample_bytree": 0.6352469619687204,
    "xgb_reg_alpha": 0.00011000140531552964,
    "xgb_reg_lambda": 0.0057466696596047495,
    "xgb_min_child_weight": 6,
    "xgb_gamma": 0.010059918873921722,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 320,
    "lgb_n_estimators": 577,
    "lgb_max_depth": 6,
    "lgb_learning_rate": 0.024659007167008043,
    "lgb_num_leaves": 38,
    "lgb_subsample": 0.6726765412383933,
    "lgb_colsample_bytree": 0.5297313767123831,
    "lgb_reg_alpha": 3.4580478891198744e-06,
    "lgb_reg_lambda": 0.00014756236863442613,
    "lgb_min_data_in_leaf": 72,
    "lgb_feature_fraction_bynode": 0.5173062189309671,
    "lgb_bagging_freq": 4,
    "lgb_min_gain_to_split": 0.7305505659128215,
    "cat_iterations": 344,
    "cat_depth": 8,
    "cat_learning_rate": 0.015675442063433895,
    "cat_l2_leaf_reg": 6.785212716021107,
    "cat_subsample": 0.5897174921932667,
    "cat_rsm": 0.5450127778700323,
    "cat_border_count": 68,
    "cat_random_strength": 3.6248287072178167,
    "cat_leaf_estimation_iterations": 17,
    "cat_bootstrap_type": "No"
  },
  "best_trial": {
    "number": 221,
    "value": 32.39810209079844,
    "state": "1"
  },
  "best_trial_number": 221,
  "best_trial_seed": 263,
  "n_trials": 722,
  "pruned_count": 0,
  "avg_trial_time": 0.0,
  "top_k_trials": [],
  "study_name": "hpo_with_features_ALKA_h1_c2",
  "symbols": [
    "ALKA"
  ],
  "horizon": 1,
  "best_model_choice": "all",
  "feature_flags": {
    "enable_external_features": true,
    "enable_fingpt_features": true,
    "enable_yolo_features": true,
    "enable_directional_loss": false,
    "enable_seed_bagging": false,
    "enable_talib_patterns": false,
    "enable_smart_ensemble": true,
    "enable_stacked_short": false,
    "enable_meta_stacking": false,
    "enable_regime_detection": true,
    "enable_fingpt": true,
    "enable_talib_patterns_short": false
  },
  "feature_params": {
    "ml_adaptive_k_1d": 1.4897905913312868,
    "ml_pattern_weight_scale_1d": 1.0225042118481937,
    "external_min_days": 59,
    "external_smooth_alpha": 0.09901106639566218,
    "regime_scale_low": 0.8253009485111868,
    "regime_scale_high": 1.1648498753936765,
    "yolo_min_conf": 0.40737092865119007,
    "smart_consensus_weight": 0.5473248255680379,
    "smart_performance_weight": 0.4453875106874246,
    "smart_sigma": 0.005705792538190418,
    "smart_weight_xgb": 1.1334805378070167,
    "smart_weight_lgbm": 1.1343438500323675,
    "smart_weight_cat": 0.9844067563864479,
    "fingpt_confidence_threshold": 0.3626887821958939
  },
  "hyperparameters": {
    "model_choice": "all",
    "xgb_n_estimators": 322,
    "xgb_max_depth": 6,
    "xgb_learning_rate": 0.01243827993996266,
    "xgb_subsample": 0.8167693518124421,
    "xgb_colsample_bytree": 0.6352469619687204,
    "xgb_reg_alpha": 0.00011000140531552964,
    "xgb_reg_lambda": 0.0057466696596047495,
    "xgb_min_child_weight": 6,
    "xgb_gamma": 0.010059918873921722,
    "xgb_grow_policy": "lossguide",
    "xgb_tree_method": "hist",
    "xgb_max_bin": 320,
    "lgb_n_estimators": 577,
    "lgb_max_depth": 6,
    "lgb_learning_rate": 0.024659007167008043,
    "lgb_num_leaves": 38,
    "lgb_subsample": 0.6726765412383933,
    "lgb_colsample_bytree": 0.5297313767123831,
    "lgb_reg_alpha": 3.4580478891198744e-06,
    "lgb_reg_lambda": 0.00014756236863442613,
    "lgb_min_data_in_leaf": 72,
    "lgb_feature_fraction_bynode": 0.5173062189309671,
    "lgb_bagging_freq": 4,
    "lgb_min_gain_to_split": 0.7305505659128215,
    "cat_iterations": 344,
    "cat_depth": 8,
    "cat_learning_rate": 0.015675442063433895,
    "cat_l2_leaf_reg": 6.785212716021107,
    "cat_subsample": 0.5897174921932667,
    "cat_rsm": 0.5450127778700323,
    "cat_border_count": 68,
    "cat_random_strength": 3.6248287072178167,
    "cat_leaf_estimation_iterations": 17,
    "cat_bootstrap_type": "No"
  },
  "features_enabled": {
    "ENABLE_EXTERNAL_FEATURES": "1",
    "ENABLE_FINGPT_FEATURES": "1",
    "ENABLE_YOLO_FEATURES": "1",
    "ML_USE_DIRECTIONAL_LOSS": "0",
    "ENABLE_SEED_BAGGING": "0",
    "ENABLE_TALIB_PATTERNS": "0",
    "ML_USE_SMART_ENSEMBLE": "1",
    "ML_USE_STACKED_SHORT": "0",
    "ENABLE_META_STACKING": "0",
    "ML_USE_REGIME_DETECTION": "1",
    "ENABLE_FINGPT": "1",
    "ML_USE_ADAPTIVE_LEARNING": "0",
    "ENABLE_XGBOOST": "1",
    "ENABLE_LIGHTGBM": "1",
    "ENABLE_CATBOOST": "1"
  },
  "best_trial_metrics": {
    "ALKA_1d": {
      "symbol": "ALKA",
      "horizon": 1,
      "split_metrics": [
        {
          "split_index": 1,
          "train_days": 450,
          "test_days": 30,
          "train_end_idx": 450,
          "test_end_idx": 480,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-06-05T00:00:00",
          "test_start": "2025-06-10T00:00:00",
          "test_end": "2025-07-22T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": 0.0031344379119460455,
              "rmse": 0.031205476635197467,
              "mape": 1.6995041704904754,
              "confidence": 0.6275466786779266
            },
            "lightgbm": {
              "raw_r2": -0.0029484440602226916,
              "rmse": 0.03127768263415668,
              "mape": 1.9011010087975224,
              "confidence": 0.6226044325872448
            },
            "catboost": {
              "raw_r2": 0.005730020827718378,
              "rmse": 0.03115088776922638,
              "mape": 1.8250675281368738,
              "confidence": 0.6296553234917069
            }
          },
          "dirhit": 66.66666666666666,
          "rmse": 0.02029083193755508,
          "mape": 3840428.1999015003,
          "nrmse": 1.008399958885505,
          "mask_count": 3,
          "mask_pct": 10.344827586206897,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": 0.0031344379119460455,
              "lightgbm": -0.0029484440602226916,
              "catboost": 0.005730020827718378
            },
            "ensemble_weights": {
              "xgboost": 0.7149901890588752,
              "lightgbm": 0.15228183507942933,
              "catboost": 0.1327279758616954
            },
            "source": "model"
          }
        },
        {
          "split_index": 2,
          "train_days": 480,
          "test_days": 30,
          "train_end_idx": 480,
          "test_end_idx": 510,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-07-22T00:00:00",
          "test_start": "2025-07-23T00:00:00",
          "test_end": "2025-09-02T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.0015728154427443464,
              "rmse": 0.03066186400590343,
              "mape": 1.7527188021505817,
              "confidence": 0.623722094038634
            },
            "lightgbm": {
              "raw_r2": -0.005826143719383614,
              "rmse": 0.030736384334352402,
              "mape": 1.861862482831228,
              "confidence": 0.6202665929535482
            },
            "catboost": {
              "raw_r2": -0.0015008856920873948,
              "rmse": 0.030670214474824563,
              "mape": 1.7626319074007222,
              "confidence": 0.6237805360981631
            }
          },
          "dirhit": 0.0,
          "rmse": 0.02447930316942915,
          "mape": 2446385.2056659227,
          "nrmse": 1.0085107418525803,
          "mask_count": 0,
          "mask_pct": 0.0,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.0015728154427443464,
              "lightgbm": -0.005826143719383614,
              "catboost": -0.0015008856920873948
            },
            "ensemble_weights": {
              "xgboost": 0.3349709740473658,
              "lightgbm": 0.33648207493786253,
              "catboost": 0.3285469510147718
            },
            "source": "model"
          }
        },
        {
          "split_index": 3,
          "train_days": 510,
          "test_days": 30,
          "train_end_idx": 510,
          "test_end_idx": 540,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-09-02T00:00:00",
          "test_start": "2025-09-03T00:00:00",
          "test_end": "2025-10-14T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.0010003814403705495,
              "rmse": 0.02986205084227751,
              "mape": 1.776504605440142,
              "confidence": 0.6241871917743407
            },
            "lightgbm": {
              "raw_r2": -0.0041528747803346215,
              "rmse": 0.02992707926386312,
              "mape": 1.872368155866076,
              "confidence": 0.6216259104709254
            },
            "catboost": {
              "raw_r2": 0.013157642017570822,
              "rmse": 0.02968293650817977,
              "mape": 1.7406669658475125,
              "confidence": 0.6356867299911108
            }
          },
          "dirhit": 52.94117647058824,
          "rmse": 0.07510253131815037,
          "mape": 103.2363846752319,
          "nrmse": 1.0432727133510447,
          "mask_count": 17,
          "mask_pct": 58.620689655172406,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.0010003814403705495,
              "lightgbm": -0.0041528747803346215,
              "catboost": 0.013157642017570822
            },
            "ensemble_weights": {
              "xgboost": 0.16443315923279359,
              "lightgbm": 0.16429921897131916,
              "catboost": 0.6712676217958872
            },
            "source": "model"
          }
        },
        {
          "split_index": 4,
          "train_days": 540,
          "test_days": 30,
          "train_end_idx": 540,
          "test_end_idx": 570,
          "train_start": "2023-08-21T00:00:00",
          "train_end": "2025-10-14T00:00:00",
          "test_start": "2025-10-15T00:00:00",
          "test_end": "2025-11-25T00:00:00",
          "valid_predictions": 29,
          "model_metrics": {
            "xgboost": {
              "raw_r2": -0.0022349365181070224,
              "rmse": 0.0344285500419006,
              "mape": 1.8424238810404385,
              "confidence": 0.6231841329751426
            },
            "lightgbm": {
              "raw_r2": -0.006014994992410132,
              "rmse": 0.034498649450626105,
              "mape": 1.8300149235443053,
              "confidence": 0.6201131849084789
            },
            "catboost": {
              "raw_r2": 0.00013713998027268617,
              "rmse": 0.03440550227527435,
              "mape": 1.7650911384706638,
              "confidence": 0.6251114262296056
            }
          },
          "dirhit": 100.0,
          "rmse": 0.030774072060158874,
          "mape": 1453274.1242623618,
          "nrmse": 0.9619968913916472,
          "mask_count": 5,
          "mask_pct": 17.24137931034483,
          "low_support": false,
          "min_mask_count": 0,
          "min_mask_pct": 0.0,
          "ensemble_debug": {
            "historical_r2": {
              "xgboost": -0.0022349365181070224,
              "lightgbm": -0.006014994992410132,
              "catboost": 0.00013713998027268617
            },
            "ensemble_weights": {
              "xgboost": 0.16476103617094937,
              "lightgbm": 0.1645751799095723,
              "catboost": 0.6706637839194785
            },
            "source": "model"
          }
        }
      ],
      "avg_dirhit": 54.90196078431372,
      "avg_nrmse": 1.0055450763701943,
      "split_count": 4,
      "avg_model_metrics": {
        "xgboost": {
          "raw_r2": -0.0004184238723189682,
          "rmse": 0.03153948538131975,
          "mape": 1.7677878647804097,
          "confidence": 0.624660024366511
        },
        "lightgbm": {
          "raw_r2": -0.004735614388087765,
          "rmse": 0.03160994892074958,
          "mape": 1.866336642759783,
          "confidence": 0.6211525302300493
        },
        "catboost": {
          "raw_r2": 0.004380979283368623,
          "rmse": 0.03147738525687627,
          "mape": 1.7733643849639429,
          "confidence": 0.6285585039526467
        }
      }
    }
  },
  "evaluation_spec": {
    "horizon": 1,
    "dirhit_threshold": 0.005,
    "min_mask_count": 5,
    "min_mask_pct": 2.5,
    "best_trial_number": 221,
    "best_trial_seed": 263,
    "scoring": {
      "formula": "score = 0.7*avg_dirhit - k*avg_nrmse",
      "k": 6.0
    },
    "symbol_specs": {
      "ALKA_1d": {
        "splits": [
          {
            "split_index": 1,
            "train_end_idx": 450,
            "test_end_idx": 480,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-06-05T00:00:00",
            "test_start": "2025-06-10T00:00:00",
            "test_end": "2025-07-22T00:00:00"
          },
          {
            "split_index": 2,
            "train_end_idx": 480,
            "test_end_idx": 510,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-07-22T00:00:00",
            "test_start": "2025-07-23T00:00:00",
            "test_end": "2025-09-02T00:00:00"
          },
          {
            "split_index": 3,
            "train_end_idx": 510,
            "test_end_idx": 540,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-09-02T00:00:00",
            "test_start": "2025-09-03T00:00:00",
            "test_end": "2025-10-14T00:00:00"
          },
          {
            "split_index": 4,
            "train_end_idx": 540,
            "test_end_idx": 570,
            "train_start": "2023-08-21T00:00:00",
            "train_end": "2025-10-14T00:00:00",
            "test_start": "2025-10-15T00:00:00",
            "test_end": "2025-11-25T00:00:00"
          }
        ]
      }
    }
  },
  "_created_at": "2025-12-03T03:02:34.702415",
  "_created_from": "study_database",
  "_filter_applied": {
    "min_mask_count": 5,
    "min_mask_pct": 2.5
  }
}